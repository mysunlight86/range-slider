!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=3)}([function(e,t,n){var i=n(1),r=n(2);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s={insert:"head",singleton:!1};i(r,s);e.exports=r.locals||{}},function(e,t,n){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function a(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},i=[],r=0;r<e.length;r++){var s=e[r],c=t.base?s[0]+t.base:s[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var d=a(u),f={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(o[d].references++,o[d].updater(f)):o.push({identifier:u,updater:m(f,t),references:1}),i.push(u)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var r=n.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=s(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,d=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function f(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=d(t,r);else{var s=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}function h(e,t,n){var i=n.css,r=n.media,s=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),s&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var p=null,v=0;function m(e,t){var n,i,r;if(t.singleton){var s=v++;n=p||(p=l(t)),i=f.bind(null,n,s,!1),r=f.bind(null,n,s,!0)}else n=l(t),i=h.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=a(n[i]);o[r].references--}for(var s=c(e,t),l=0;l<n.length;l++){var u=a(n[l]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}n=s}}}},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);class i{update(e){console.log("ModelObserver: Reacted to the event.")}}class r{constructor(){this.observers=[]}attach(e){if(this.observers.includes(e))return console.log("Model: Presenter has been attached already.");console.log("Model: Attached a presenter."),this.observers.push(e)}detach(e){const t=this.observers.indexOf(e);if(-1===t)return console.log("Subject: Nonexistent observer.");this.observers.splice(t,1),console.log("Subject: Detached an observer.")}notify(){console.log("Model: Notifying observers...");for(const e of this.observers)e.update(this)}getData(e){this._min=e.min,this._max=e.max,this._step=e.step,this._kind=e.kind,this._isBasic=e.isBasic,this._values=e.values,console.log("Model: My state has just changed"),this.notify()}}class s{constructor(e,t){this._selector=e,t||(t={}),this._min=t.min?t.min:0,this._max=t.max?t.max:300,this._step=t.step?t.step:57,this._kind=t.kind?t.kind:"horizontal",this._isBasic=!t.isBasic||t.isBasic,this._values=t.values?t.values:[this._step]}init(){const e=new r,t=new i;e.attach(t),this.setData(),e.getData(this._options)}setData(){this._options={min:this._min,max:this._max,step:this._step,kind:this._kind,isBasic:this._isBasic,values:this._values},console.log(this._options)}}new s(".slider1").init();new s(".slider2",{min:40,step:60,max:245}).init();new s(".slider3",{values:[256]}).init()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLnNjc3M/MjFiYSIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvcHJlc2VudGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL21vZGVsLnRzIiwid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL3NsaWRlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJhcGkiLCJjb250ZW50IiwiZGVmYXVsdCIsIm9wdGlvbnMiLCJsb2NhbHMiLCJtZW1vIiwiaXNPbGRJRSIsIkJvb2xlYW4iLCJ3aW5kb3ciLCJkb2N1bWVudCIsImFsbCIsImF0b2IiLCJnZXRUYXJnZXQiLCJ0YXJnZXQiLCJzdHlsZVRhcmdldCIsInF1ZXJ5U2VsZWN0b3IiLCJIVE1MSUZyYW1lRWxlbWVudCIsImNvbnRlbnREb2N1bWVudCIsImhlYWQiLCJlIiwic3R5bGVzSW5Eb20iLCJnZXRJbmRleEJ5SWRlbnRpZmllciIsImlkZW50aWZpZXIiLCJyZXN1bHQiLCJsZW5ndGgiLCJtb2R1bGVzVG9Eb20iLCJsaXN0IiwiaWRDb3VudE1hcCIsImlkZW50aWZpZXJzIiwiaXRlbSIsImlkIiwiYmFzZSIsImNvdW50IiwiY29uY2F0IiwiaW5kZXgiLCJvYmoiLCJjc3MiLCJtZWRpYSIsInNvdXJjZU1hcCIsInJlZmVyZW5jZXMiLCJ1cGRhdGVyIiwicHVzaCIsImFkZFN0eWxlIiwiaW5zZXJ0U3R5bGVFbGVtZW50Iiwic3R5bGUiLCJjcmVhdGVFbGVtZW50IiwiYXR0cmlidXRlcyIsIm5vbmNlIiwia2V5cyIsImZvckVhY2giLCJzZXRBdHRyaWJ1dGUiLCJpbnNlcnQiLCJFcnJvciIsImFwcGVuZENoaWxkIiwidGV4dFN0b3JlIiwicmVwbGFjZVRleHQiLCJyZXBsYWNlbWVudCIsImZpbHRlciIsImpvaW4iLCJhcHBseVRvU2luZ2xldG9uVGFnIiwicmVtb3ZlIiwic3R5bGVTaGVldCIsImNzc1RleHQiLCJjc3NOb2RlIiwiY3JlYXRlVGV4dE5vZGUiLCJjaGlsZE5vZGVzIiwicmVtb3ZlQ2hpbGQiLCJpbnNlcnRCZWZvcmUiLCJhcHBseVRvVGFnIiwicmVtb3ZlQXR0cmlidXRlIiwiYnRvYSIsInVuZXNjYXBlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsImZpcnN0Q2hpbGQiLCJzaW5nbGV0b24iLCJzaW5nbGV0b25Db3VudGVyIiwidXBkYXRlIiwic3R5bGVJbmRleCIsInBhcmVudE5vZGUiLCJyZW1vdmVTdHlsZUVsZW1lbnQiLCJuZXdPYmoiLCJsYXN0SWRlbnRpZmllcnMiLCJuZXdMaXN0IiwidG9TdHJpbmciLCJuZXdMYXN0SWRlbnRpZmllcnMiLCJfaSIsIl9pbmRleCIsInNwbGljZSIsIlByZXNlbnRlciIsIm1vZGVsIiwiY29uc29sZSIsImxvZyIsIk1vZGVsIiwib2JzZXJ2ZXJzIiwib2JzZXJ2ZXIiLCJ0aGlzIiwiaW5jbHVkZXMiLCJvYnNlcnZlckluZGV4IiwiaW5kZXhPZiIsIl9taW4iLCJtaW4iLCJfbWF4IiwibWF4IiwiX3N0ZXAiLCJzdGVwIiwiX2tpbmQiLCJraW5kIiwiX2lzQmFzaWMiLCJpc0Jhc2ljIiwiX3ZhbHVlcyIsInZhbHVlcyIsIm5vdGlmeSIsInNlbGVjdG9yIiwiX3NlbGVjdG9yIiwicHJlc2VudGVyIiwiYXR0YWNoIiwic2V0RGF0YSIsImdldERhdGEiLCJfb3B0aW9ucyIsImluaXQiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2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TyxXQUFZLENBQUNULE9BQVEsQ0FBQyxPQUNqRFMiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL2Rpc3RcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwidmFyIGFwaSA9IHJlcXVpcmUoXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCIpO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi9ub2RlX21vZHVsZXMvbWluaS1jc3MtZXh0cmFjdC1wbHVnaW4vZGlzdC9sb2FkZXIuanMhLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vc3R5bGUuc2Nzc1wiKTtcblxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgICAgfVxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHMgfHwge307IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBpc09sZElFID0gZnVuY3Rpb24gaXNPbGRJRSgpIHtcbiAgdmFyIG1lbW87XG4gIHJldHVybiBmdW5jdGlvbiBtZW1vcml6ZSgpIHtcbiAgICBpZiAodHlwZW9mIG1lbW8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvLyBUZXN0IGZvciBJRSA8PSA5IGFzIHByb3Bvc2VkIGJ5IEJyb3dzZXJoYWNrc1xuICAgICAgLy8gQHNlZSBodHRwOi8vYnJvd3NlcmhhY2tzLmNvbS8jaGFjay1lNzFkODY5MmY2NTMzNDE3M2ZlZTcxNWMyMjJjYjgwNVxuICAgICAgLy8gVGVzdHMgZm9yIGV4aXN0ZW5jZSBvZiBzdGFuZGFyZCBnbG9iYWxzIGlzIHRvIGFsbG93IHN0eWxlLWxvYWRlclxuICAgICAgLy8gdG8gb3BlcmF0ZSBjb3JyZWN0bHkgaW50byBub24tc3RhbmRhcmQgZW52aXJvbm1lbnRzXG4gICAgICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrLWNvbnRyaWIvc3R5bGUtbG9hZGVyL2lzc3Vlcy8xNzdcbiAgICAgIG1lbW8gPSBCb29sZWFuKHdpbmRvdyAmJiBkb2N1bWVudCAmJiBkb2N1bWVudC5hbGwgJiYgIXdpbmRvdy5hdG9iKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVtbztcbiAgfTtcbn0oKTtcblxudmFyIGdldFRhcmdldCA9IGZ1bmN0aW9uIGdldFRhcmdldCgpIHtcbiAgdmFyIG1lbW8gPSB7fTtcbiAgcmV0dXJuIGZ1bmN0aW9uIG1lbW9yaXplKHRhcmdldCkge1xuICAgIGlmICh0eXBlb2YgbWVtb1t0YXJnZXRdID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdmFyIHN0eWxlVGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpOyAvLyBTcGVjaWFsIGNhc2UgdG8gcmV0dXJuIGhlYWQgb2YgaWZyYW1lIGluc3RlYWQgb2YgaWZyYW1lIGl0c2VsZlxuXG4gICAgICBpZiAod2luZG93LkhUTUxJRnJhbWVFbGVtZW50ICYmIHN0eWxlVGFyZ2V0IGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gVGhpcyB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhY2Nlc3MgdG8gaWZyYW1lIGlzIGJsb2NrZWRcbiAgICAgICAgICAvLyBkdWUgdG8gY3Jvc3Mtb3JpZ2luIHJlc3RyaWN0aW9uc1xuICAgICAgICAgIHN0eWxlVGFyZ2V0ID0gc3R5bGVUYXJnZXQuY29udGVudERvY3VtZW50LmhlYWQ7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxuICAgICAgICAgIHN0eWxlVGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtZW1vW3RhcmdldF0gPSBzdHlsZVRhcmdldDtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVtb1t0YXJnZXRdO1xuICB9O1xufSgpO1xuXG52YXIgc3R5bGVzSW5Eb20gPSBbXTtcblxuZnVuY3Rpb24gZ2V0SW5kZXhCeUlkZW50aWZpZXIoaWRlbnRpZmllcikge1xuICB2YXIgcmVzdWx0ID0gLTE7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXNJbkRvbS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChzdHlsZXNJbkRvbVtpXS5pZGVudGlmaWVyID09PSBpZGVudGlmaWVyKSB7XG4gICAgICByZXN1bHQgPSBpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gbW9kdWxlc1RvRG9tKGxpc3QsIG9wdGlvbnMpIHtcbiAgdmFyIGlkQ291bnRNYXAgPSB7fTtcbiAgdmFyIGlkZW50aWZpZXJzID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgIHZhciBpZCA9IG9wdGlvbnMuYmFzZSA/IGl0ZW1bMF0gKyBvcHRpb25zLmJhc2UgOiBpdGVtWzBdO1xuICAgIHZhciBjb3VudCA9IGlkQ291bnRNYXBbaWRdIHx8IDA7XG4gICAgdmFyIGlkZW50aWZpZXIgPSBcIlwiLmNvbmNhdChpZCwgXCIgXCIpLmNvbmNhdChjb3VudCk7XG4gICAgaWRDb3VudE1hcFtpZF0gPSBjb3VudCArIDE7XG4gICAgdmFyIGluZGV4ID0gZ2V0SW5kZXhCeUlkZW50aWZpZXIoaWRlbnRpZmllcik7XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIGNzczogaXRlbVsxXSxcbiAgICAgIG1lZGlhOiBpdGVtWzJdLFxuICAgICAgc291cmNlTWFwOiBpdGVtWzNdXG4gICAgfTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIHN0eWxlc0luRG9tW2luZGV4XS5yZWZlcmVuY2VzKys7XG4gICAgICBzdHlsZXNJbkRvbVtpbmRleF0udXBkYXRlcihvYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZXNJbkRvbS5wdXNoKHtcbiAgICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllcixcbiAgICAgICAgdXBkYXRlcjogYWRkU3R5bGUob2JqLCBvcHRpb25zKSxcbiAgICAgICAgcmVmZXJlbmNlczogMVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWRlbnRpZmllcnMucHVzaChpZGVudGlmaWVyKTtcbiAgfVxuXG4gIHJldHVybiBpZGVudGlmaWVycztcbn1cblxuZnVuY3Rpb24gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpIHtcbiAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgdmFyIGF0dHJpYnV0ZXMgPSBvcHRpb25zLmF0dHJpYnV0ZXMgfHwge307XG5cbiAgaWYgKHR5cGVvZiBhdHRyaWJ1dGVzLm5vbmNlID09PSAndW5kZWZpbmVkJykge1xuICAgIHZhciBub25jZSA9IHR5cGVvZiBfX3dlYnBhY2tfbm9uY2VfXyAhPT0gJ3VuZGVmaW5lZCcgPyBfX3dlYnBhY2tfbm9uY2VfXyA6IG51bGw7XG5cbiAgICBpZiAobm9uY2UpIHtcbiAgICAgIGF0dHJpYnV0ZXMubm9uY2UgPSBub25jZTtcbiAgICB9XG4gIH1cblxuICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICB9KTtcblxuICBpZiAodHlwZW9mIG9wdGlvbnMuaW5zZXJ0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgb3B0aW9ucy5pbnNlcnQoc3R5bGUpO1xuICB9IGVsc2Uge1xuICAgIHZhciB0YXJnZXQgPSBnZXRUYXJnZXQob3B0aW9ucy5pbnNlcnQgfHwgJ2hlYWQnKTtcblxuICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBmaW5kIGEgc3R5bGUgdGFyZ2V0LiBUaGlzIHByb2JhYmx5IG1lYW5zIHRoYXQgdGhlIHZhbHVlIGZvciB0aGUgJ2luc2VydCcgcGFyYW1ldGVyIGlzIGludmFsaWQuXCIpO1xuICAgIH1cblxuICAgIHRhcmdldC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIH1cblxuICByZXR1cm4gc3R5bGU7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSkge1xuICAvLyBpc3RhbmJ1bCBpZ25vcmUgaWZcbiAgaWYgKHN0eWxlLnBhcmVudE5vZGUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBzdHlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlKTtcbn1cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICAqL1xuXG5cbnZhciByZXBsYWNlVGV4dCA9IGZ1bmN0aW9uIHJlcGxhY2VUZXh0KCkge1xuICB2YXIgdGV4dFN0b3JlID0gW107XG4gIHJldHVybiBmdW5jdGlvbiByZXBsYWNlKGluZGV4LCByZXBsYWNlbWVudCkge1xuICAgIHRleHRTdG9yZVtpbmRleF0gPSByZXBsYWNlbWVudDtcbiAgICByZXR1cm4gdGV4dFN0b3JlLmZpbHRlcihCb29sZWFuKS5qb2luKCdcXG4nKTtcbiAgfTtcbn0oKTtcblxuZnVuY3Rpb24gYXBwbHlUb1NpbmdsZXRvblRhZyhzdHlsZSwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XG4gIHZhciBjc3MgPSByZW1vdmUgPyAnJyA6IG9iai5tZWRpYSA/IFwiQG1lZGlhIFwiLmNvbmNhdChvYmoubWVkaWEsIFwiIHtcIikuY29uY2F0KG9iai5jc3MsIFwifVwiKSA6IG9iai5jc3M7IC8vIEZvciBvbGQgSUVcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgICovXG5cbiAgaWYgKHN0eWxlLnN0eWxlU2hlZXQpIHtcbiAgICBzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSByZXBsYWNlVGV4dChpbmRleCwgY3NzKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XG4gICAgdmFyIGNoaWxkTm9kZXMgPSBzdHlsZS5jaGlsZE5vZGVzO1xuXG4gICAgaWYgKGNoaWxkTm9kZXNbaW5kZXhdKSB7XG4gICAgICBzdHlsZS5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XG4gICAgfVxuXG4gICAgaWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICBzdHlsZS5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZS5hcHBlbmRDaGlsZChjc3NOb2RlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gYXBwbHlUb1RhZyhzdHlsZSwgb3B0aW9ucywgb2JqKSB7XG4gIHZhciBjc3MgPSBvYmouY3NzO1xuICB2YXIgbWVkaWEgPSBvYmoubWVkaWE7XG4gIHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xuXG4gIGlmIChtZWRpYSkge1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnbWVkaWEnLCBtZWRpYSk7XG4gIH0gZWxzZSB7XG4gICAgc3R5bGUucmVtb3ZlQXR0cmlidXRlKCdtZWRpYScpO1xuICB9XG5cbiAgaWYgKHNvdXJjZU1hcCAmJiBidG9hKSB7XG4gICAgY3NzICs9IFwiXFxuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxcIi5jb25jYXQoYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSwgXCIgKi9cIik7XG4gIH0gLy8gRm9yIG9sZCBJRVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAgKi9cblxuXG4gIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7XG4gICAgc3R5bGUuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xuICB9IGVsc2Uge1xuICAgIHdoaWxlIChzdHlsZS5maXJzdENoaWxkKSB7XG4gICAgICBzdHlsZS5yZW1vdmVDaGlsZChzdHlsZS5maXJzdENoaWxkKTtcbiAgICB9XG5cbiAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcbiAgfVxufVxuXG52YXIgc2luZ2xldG9uID0gbnVsbDtcbnZhciBzaW5nbGV0b25Db3VudGVyID0gMDtcblxuZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XG4gIHZhciBzdHlsZTtcbiAgdmFyIHVwZGF0ZTtcbiAgdmFyIHJlbW92ZTtcblxuICBpZiAob3B0aW9ucy5zaW5nbGV0b24pIHtcbiAgICB2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcbiAgICBzdHlsZSA9IHNpbmdsZXRvbiB8fCAoc2luZ2xldG9uID0gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpKTtcbiAgICB1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIGZhbHNlKTtcbiAgICByZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIHRydWUpO1xuICB9IGVsc2Uge1xuICAgIHN0eWxlID0gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpO1xuICAgIHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZSwgb3B0aW9ucyk7XG5cbiAgICByZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGUpO1xuICAgIH07XG4gIH1cblxuICB1cGRhdGUob2JqKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG5ld09iaikge1xuICAgIGlmIChuZXdPYmopIHtcbiAgICAgIGlmIChuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB1cGRhdGUob2JqID0gbmV3T2JqKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlKCk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChsaXN0LCBvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OyAvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cbiAgLy8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxuXG4gIGlmICghb3B0aW9ucy5zaW5nbGV0b24gJiYgdHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uICE9PSAnYm9vbGVhbicpIHtcbiAgICBvcHRpb25zLnNpbmdsZXRvbiA9IGlzT2xkSUUoKTtcbiAgfVxuXG4gIGxpc3QgPSBsaXN0IHx8IFtdO1xuICB2YXIgbGFzdElkZW50aWZpZXJzID0gbW9kdWxlc1RvRG9tKGxpc3QsIG9wdGlvbnMpO1xuICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcbiAgICBuZXdMaXN0ID0gbmV3TGlzdCB8fCBbXTtcblxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobmV3TGlzdCkgIT09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhc3RJZGVudGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGlkZW50aWZpZXIgPSBsYXN0SWRlbnRpZmllcnNbaV07XG4gICAgICB2YXIgaW5kZXggPSBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKTtcbiAgICAgIHN0eWxlc0luRG9tW2luZGV4XS5yZWZlcmVuY2VzLS07XG4gICAgfVxuXG4gICAgdmFyIG5ld0xhc3RJZGVudGlmaWVycyA9IG1vZHVsZXNUb0RvbShuZXdMaXN0LCBvcHRpb25zKTtcblxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBsYXN0SWRlbnRpZmllcnMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICB2YXIgX2lkZW50aWZpZXIgPSBsYXN0SWRlbnRpZmllcnNbX2ldO1xuXG4gICAgICB2YXIgX2luZGV4ID0gZ2V0SW5kZXhCeUlkZW50aWZpZXIoX2lkZW50aWZpZXIpO1xuXG4gICAgICBpZiAoc3R5bGVzSW5Eb21bX2luZGV4XS5yZWZlcmVuY2VzID09PSAwKSB7XG4gICAgICAgIHN0eWxlc0luRG9tW19pbmRleF0udXBkYXRlcigpO1xuXG4gICAgICAgIHN0eWxlc0luRG9tLnNwbGljZShfaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxhc3RJZGVudGlmaWVycyA9IG5ld0xhc3RJZGVudGlmaWVycztcbiAgfTtcbn07IiwiLy8gaW1wb3J0IHsgU3ViamVjdCwgQ29uY3JldGVTdWJqZWN0IH0gZnJvbSAnLi9hcHAnO1xyXG5pbXBvcnQgU3ViamVjdCBmcm9tICcuL2FwcCc7XHJcbi8vIGltcG9ydCBTbGlkZXJCb2R5IGZyb20gJy4vc2xpZGVyQm9keSc7XHJcbmltcG9ydCBNb2RlbCBmcm9tICcuL21vZGVsJztcclxuaW1wb3J0IFZpZXcgZnJvbSAnLi92aWV3JztcclxuXHJcbnR5cGUgb3B0aW9uc1R5cGUgPSB7XHJcbiAgbWluPzogbnVtYmVyLFxyXG4gIG1heD86IG51bWJlcixcclxuICBzdGVwPzogbnVtYmVyLFxyXG4gIGtpbmQ/OiBzdHJpbmcsXHJcbiAgaXNCYXNpYz86IGJvb2xlYW4sXHJcbiAgdmFsdWVzPzogbnVtYmVyW11cclxufTtcclxuXHJcbi8qKlxyXG4qINCY0L3RgtC10YDRhNC10LnRgSDQndCw0LHQu9GO0LTQsNGC0LXQu9GPINC+0LHRitGP0LLQu9GP0LXRgiDQvNC10YLQvtC0INGD0LLQtdC00L7QvNC70LXQvdC40Y8sINC60L7RgtC+0YDRi9C5INC40LfQtNCw0YLQtdC70LhcclxuKiDQuNGB0L/QvtC70YzQt9GD0Y7RgiDQtNC70Y8g0L7Qv9C+0LLQtdGJ0LXQvdC40Y8g0YHQstC+0LjRhSDQv9C+0LTQv9C40YHRh9C40LrQvtCyLlxyXG4qL1xyXG5pbnRlcmZhY2UgT2JzZXJ2ZXIge1xyXG4gIC8vINCf0L7Qu9GD0YfQuNGC0Ywg0L7QsdC90L7QstC70LXQvdC40LUg0L7RgiDRgdGD0LHRitC10LrRgtCwLlxyXG4gIHVwZGF0ZShzdWJqZWN0OiBTdWJqZWN0KTogdm9pZDtcclxufVxyXG5cclxuLyoqXHJcbiog0JrQvtC90LrRgNC10YLQvdGL0LUg0J3QsNCx0LvRjtC00LDRgtC10LvQuCDRgNC10LDQs9C40YDRg9GO0YIg0L3QsCDQvtCx0L3QvtCy0LvQtdC90LjRjywg0LLRi9C/0YPRidC10L3QvdGL0LUg0JjQt9C00LDRgtC10LvQtdC8LCDQulxyXG4qINC60L7RgtC+0YDQvtC80YMg0L7QvdC4INC/0YDQuNC60YDQtdC/0LvQtdC90YsuXHJcbiovXHJcbi8vIGNsYXNzIENvbmNyZXRlT2JzZXJ2ZXJBIGltcGxlbWVudHMgT2JzZXJ2ZXIge1xyXG4vLyAgIHB1YmxpYyB1cGRhdGUoc3ViamVjdDogU3ViamVjdCk6IHZvaWQge1xyXG4vLyAgICAgaWYgKHN1YmplY3QgaW5zdGFuY2VvZiBDb25jcmV0ZVN1YmplY3QgJiYgc3ViamVjdC5zdGF0ZSA8IDMpIHtcclxuLy8gICAgICAgY29uc29sZS5sb2coJ0NvbmNyZXRlT2JzZXJ2ZXJBOiBSZWFjdGVkIHRvIHRoZSBldmVudC4nKTtcclxuLy8gICAgIH1cclxuLy8gICB9XHJcbi8vIH1cclxuXHJcbmNsYXNzIFByZXNlbnRlciBpbXBsZW1lbnRzIE9ic2VydmVyIHtcclxuICAvLyBtb2RlbE9wdGlvbnM6IHttaW46IG51bWJlciwgbWF4OiBudW1iZXIsIHN0ZXA6IG51bWJlcn07XHJcbiAgX3NlbGVjdG9yO1xyXG4gIF9vcHRpb25zO1xyXG5cclxuICAvLyBjb25zdHJ1Y3RvcihzZWxlY3Rvcj86IHN0cmluZywgb3B0aW9ucz86IG9wdGlvbnNUeXBlKSB7XHJcbiAgLy8gICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gIC8vICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgLy8gfVxyXG5cclxuICAvLyBzZXREYXRhVG9Nb2RlbCgpIHtcclxuICAvLyAgIGNvbnN0IG1vZGVsOiBNb2RlbCA9IG5ldyBNb2RlbCgpO1xyXG4gIC8vICAgbW9kZWwuZ2V0RGF0YSgpO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gdHJhbnNmZXJNb2RlbERhdGEobW9kZWw6IE1vZGVsLCB2aWV3OiBWaWV3KSB7XHJcbiAgLy8gICB0aGlzLm1vZGVsT3B0aW9ucyA9IG1vZGVsLmNhbGNVbml0KCk7XHJcbiAgLy8gICBjb25zb2xlLmxvZyh0aGlzLm1vZGVsT3B0aW9ucyk7XHJcbiAgLy8gICB2aWV3LnNob3dTY2FsZSh0aGlzLm1vZGVsT3B0aW9ucy5taW4sIHRoaXMubW9kZWxPcHRpb25zLm1heCwgdGhpcy5tb2RlbE9wdGlvbnMuc3RlcCk7XHJcbiAgLy8gICAvLyBjb25zb2xlLmxvZygnTW9kZWxPYnNlcnZlcjogUmVhY3RlZCB0byB0aGUgZXZlbnQuJyk7XHJcbiAgLy8gICAvLyBpZiAobW9kZWwgaW5zdGFuY2VvZiBNb2RlbCkge1xyXG4gIC8vICAgLy8gICB0aGlzLm1vZGVsT3B0aW9ucyA9IG1vZGVsLmNhbGNVbml0KCk7XHJcbiAgLy8gICAvLyAgIGNvbnNvbGUubG9nKHRoaXMubW9kZWxPcHRpb25zKTtcclxuICAvLyAgICAgLy8gY29uc3QgdmlldyA9IG5ldyBWaWV3KCk7XHJcbiAgLy8gICAgIC8vIHZpZXcuc2hvd1NjYWxlKHRoaXMubW9kZWxPcHRpb25zLm1pbiwgdGhpcy5tb2RlbE9wdGlvbnMubWF4LCB0aGlzLm1vZGVsT3B0aW9ucy5zdGVwKTtcclxuICAvLyAgICAgLy8gY29uc29sZS5sb2coJ01vZGVsT2JzZXJ2ZXI6IFJlYWN0ZWQgdG8gdGhlIGV2ZW50LicpO1xyXG4gIC8vICAgLy8gfVxyXG4gIC8vIH1cclxuXHJcbiAgLy8gdHJhbnNmZXIoKSB7XHJcbiAgLy8gICBjb25zdCB2aWV3OiBWaWV3ID0gbmV3IFZpZXcoKTtcclxuICAgIC8vIHJldHVybiB2aWV3LmdldFdpZHRoU2xpZGVyKCk7XHJcbiAgLy8gfVxyXG5cclxuICB1cGRhdGUobW9kZWw6IE1vZGVsKSB7XHJcbiAgICBjb25zb2xlLmxvZygnTW9kZWxPYnNlcnZlcjogUmVhY3RlZCB0byB0aGUgZXZlbnQuJyk7XHJcbiAgICAvLyBpZiAobW9kZWwgaW5zdGFuY2VvZiBNb2RlbCkge1xyXG4gICAgLy8gICB0aGlzLm1vZGVsT3B0aW9ucyA9IG1vZGVsLmNhbGNVbml0KCk7XHJcbiAgICAvLyAgIGNvbnNvbGUubG9nKHRoaXMubW9kZWxPcHRpb25zKTtcclxuICAgIC8vICAgY29uc3QgdmlldyA9IG5ldyBWaWV3KCk7XHJcbiAgICAvLyAgIHZpZXcuc2hvd1NjYWxlKHRoaXMubW9kZWxPcHRpb25zLm1pbiwgdGhpcy5tb2RlbE9wdGlvbnMubWF4LCB0aGlzLm1vZGVsT3B0aW9ucy5zdGVwKTtcclxuICAgIC8vICAgY29uc29sZS5sb2coJ01vZGVsT2JzZXJ2ZXI6IFJlYWN0ZWQgdG8gdGhlIGV2ZW50LicpO1xyXG4gICAgLy8gfVxyXG4gIH1cclxufVxyXG5cclxuLy8gY2xhc3MgVmlld09ic2VydmVyIGltcGxlbWVudHMgT2JzZXJ2ZXIge1xyXG4vLyAgIHVwZGF0ZSh2aWV3KSB7XHJcblxyXG4vLyAgIH1cclxuLy8gfVxyXG5cclxuLy8gY2xhc3MgQ29uY3JldGVPYnNlcnZlckIgaW1wbGVtZW50cyBPYnNlcnZlciB7XHJcbi8vICAgaXNTdWJqZWN0U2F0aXNmaWVzKHN1YmplY3QpIHtcclxuLy8gICAgIHJldHVybiBzdWJqZWN0IGluc3RhbmNlb2YgQ29uY3JldGVTdWJqZWN0ICYmIChzdWJqZWN0LnN0YXRlID09PSAwIHx8IHN1YmplY3Quc3RhdGUgPj0gMik7XHJcbi8vICAgfVxyXG5cclxuLy8gICBwdWJsaWMgdXBkYXRlKHN1YmplY3Q6IFN1YmplY3QpOiB2b2lkIHtcclxuLy8gICAgIGlmICh0aGlzLmlzU3ViamVjdFNhdGlzZmllcyhzdWJqZWN0KSkge1xyXG4vLyAgICAgICBjb25zb2xlLmxvZygnQ29uY3JldGVPYnNlcnZlckI6IFJlYWN0ZWQgdG8gdGhlIGV2ZW50LicpO1xyXG4vLyAgICAgfVxyXG4vLyAgIH1cclxuLy8gfVxyXG5cclxuLy8gZXhwb3J0IHsgT2JzZXJ2ZXIsIENvbmNyZXRlT2JzZXJ2ZXJBLCBDb25jcmV0ZU9ic2VydmVyQiwgUHJlc2VudGVyIH07XHJcbmV4cG9ydCB7IE9ic2VydmVyLCBQcmVzZW50ZXIgfTtcclxuIiwiLy8gaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJy4vYXBwJztcclxuaW1wb3J0IFN1YmplY3QgZnJvbSAnLi9hcHAnO1xyXG5pbXBvcnQgeyBPYnNlcnZlciB9IGZyb20gJy4vcHJlc2VudGVyJztcclxuXHJcbnR5cGUgb3B0aW9ucyA9IHtcclxuICBtaW4/OiBudW1iZXI7XHJcbiAgbWF4PzogbnVtYmVyO1xyXG4gIHN0ZXA/OiBudW1iZXI7XHJcbiAga2luZD86IHN0cmluZztcclxuICBpc0Jhc2ljPzogYm9vbGVhbjtcclxuICB2YWx1ZXM/OiBudW1iZXJbXTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGVsIGltcGxlbWVudHMgU3ViamVjdCB7XHJcbiAgcHJpdmF0ZSBfbWluOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBfbWF4OiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBfc3RlcDogbnVtYmVyO1xyXG4gIHByaXZhdGUgX2tpbmQ6IHN0cmluZztcclxuICBwcml2YXRlIF9pc0Jhc2ljOiBib29sZWFuO1xyXG4gIHByaXZhdGUgX3ZhbHVlczogbnVtYmVyW107XHJcblxyXG4gIC8vIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBvcHRpb25zKSB7XHJcbiAgLy8gICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fVxyXG4gIC8vICAgdGhpcy5fbWluID0gb3B0aW9ucy5taW4gPyBvcHRpb25zLm1pbiA6IDA7XHJcbiAgLy8gICB0aGlzLl9tYXggPSBvcHRpb25zLm1heCA/IG9wdGlvbnMubWF4IDogMzAwO1xyXG4gIC8vICAgdGhpcy5fc3RlcCA9IG9wdGlvbnMuc3RlcCA/IG9wdGlvbnMuc3RlcCA6IDUwO1xyXG4gIC8vICAgdGhpcy5fa2luZCA9IG9wdGlvbnMua2luZCA/IG9wdGlvbnMua2luZCA6ICdob3Jpem9udGFsJztcclxuICAvLyAgIHRoaXMuX2lzQmFzaWMgPSBvcHRpb25zLmlzQmFzaWMgPyBvcHRpb25zLmlzQmFzaWMgOiB0cnVlO1xyXG4gICAgLy8gdGhpcy5ub3RpZnkoKTtcclxuICAvLyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEB0eXBlIHtPYnNlcnZlcltdfSDQodC/0LjRgdC+0Log0L/QvtC00L/QuNGB0YfQuNC60L7Qsi4g0JIg0YDQtdCw0LvRjNC90L7QuSDQttC40LfQvdC4INGB0L/QuNGB0L7QulxyXG4gICAqINC/0L7QtNC/0LjRgdGH0LjQutC+0LIg0LzQvtC20LXRgiDRhdGA0LDQvdC40YLRjNGB0Y8g0LIg0LHQvtC70LXQtSDQv9C+0LTRgNC+0LHQvdC+0Lwg0LLQuNC00LUgKNC60LvQsNGB0YHQuNGE0LjRhtC40YDRg9C10YLRgdGPINC/0L5cclxuICAgKiDRgtC40L/RgyDRgdC+0LHRi9GC0LjRjyDQuCDRgi7QtC4pXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvYnNlcnZlcnM6IE9ic2VydmVyW10gPSBbXTtcclxuXHJcbiAgLyoqXHJcbiAgICog0JzQtdGC0L7QtNGLINGD0L/RgNCw0LLQu9C10L3QuNGPINC/0L7QtNC/0LjRgdC60L7QuS5cclxuICAgKi9cclxuICBwdWJsaWMgYXR0YWNoKG9ic2VydmVyOiBPYnNlcnZlcik6IHZvaWQge1xyXG4gICAgY29uc3QgaXNFeGlzdCA9IHRoaXMub2JzZXJ2ZXJzLmluY2x1ZGVzKG9ic2VydmVyKTtcclxuICAgIGlmIChpc0V4aXN0KSB7XHJcbiAgICAgIHJldHVybiBjb25zb2xlLmxvZygnTW9kZWw6IFByZXNlbnRlciBoYXMgYmVlbiBhdHRhY2hlZCBhbHJlYWR5LicpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKCdNb2RlbDogQXR0YWNoZWQgYSBwcmVzZW50ZXIuJyk7XHJcbiAgICB0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBkZXRhY2gob2JzZXJ2ZXI6IE9ic2VydmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCBvYnNlcnZlckluZGV4ID0gdGhpcy5vYnNlcnZlcnMuaW5kZXhPZihvYnNlcnZlcik7XHJcbiAgICBpZiAob2JzZXJ2ZXJJbmRleCA9PT0gLTEpIHtcclxuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCdTdWJqZWN0OiBOb25leGlzdGVudCBvYnNlcnZlci4nKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLm9ic2VydmVycy5zcGxpY2Uob2JzZXJ2ZXJJbmRleCwgMSk7XHJcbiAgICBjb25zb2xlLmxvZygnU3ViamVjdDogRGV0YWNoZWQgYW4gb2JzZXJ2ZXIuJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDQl9Cw0L/Rg9GB0Log0L7QsdC90L7QstC70LXQvdC40Y8g0LIg0LrQsNC20LTQvtC8INC/0L7QtNC/0LjRgdGH0LjQutC1LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBub3RpZnkoKTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnTW9kZWw6IE5vdGlmeWluZyBvYnNlcnZlcnMuLi4nKTtcclxuICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgdGhpcy5vYnNlcnZlcnMpIHtcclxuICAgICAgb2JzZXJ2ZXIudXBkYXRlKHRoaXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0RGF0YShvcHRpb25zOiBvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9taW4gPSBvcHRpb25zLm1pbjtcclxuICAgIHRoaXMuX21heCA9IG9wdGlvbnMubWF4O1xyXG4gICAgdGhpcy5fc3RlcCA9IG9wdGlvbnMuc3RlcDtcclxuICAgIHRoaXMuX2tpbmQgPSBvcHRpb25zLmtpbmQ7XHJcbiAgICB0aGlzLl9pc0Jhc2ljID0gb3B0aW9ucy5pc0Jhc2ljO1xyXG4gICAgdGhpcy5fdmFsdWVzID0gb3B0aW9ucy52YWx1ZXM7XHJcbiAgICBjb25zb2xlLmxvZyhgTW9kZWw6IE15IHN0YXRlIGhhcyBqdXN0IGNoYW5nZWRgKTtcclxuICAgIHRoaXMubm90aWZ5KCk7XHJcbiAgfVxyXG5cclxuICAvLyBjYWxjVW5pdCgpIHtcclxuICAvLyAgIGNvbnNvbGUubG9nKGBNb2RlbDogTXkgc3RhdGUgaGFzIGp1c3QgY2hhbmdlZGApO1xyXG5cclxuICAvLyAgIHJldHVybiB7XHJcbiAgLy8gICAgIG1pbjogdGhpcy5fbWluLFxyXG4gIC8vICAgICBtYXg6IHRoaXMuX21heCxcclxuICAvLyAgICAgc3RlcDogdGhpcy5fc3RlcFxyXG4gIC8vICAgfTtcclxuICAvLyB9XHJcbn1cclxuIiwiLy8gaW1wb3J0IFZpZXcgZnJvbSAnLi92aWV3JztcclxuaW1wb3J0IHsgUHJlc2VudGVyIH0gZnJvbSAnLi9wcmVzZW50ZXInO1xyXG5pbXBvcnQgTW9kZWwgZnJvbSAnLi9tb2RlbCc7XHJcblxyXG50eXBlIG9wdGlvbnNUeXBlID0ge1xyXG4gIG1pbj86IG51bWJlcixcclxuICBtYXg/OiBudW1iZXIsXHJcbiAgc3RlcD86IG51bWJlcixcclxuICBraW5kPzogc3RyaW5nLFxyXG4gIGlzQmFzaWM/OiBib29sZWFuLFxyXG4gIHZhbHVlcz86IG51bWJlcltdXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTbGlkZXIge1xyXG4gIF9zZWxlY3Rvcjogc3RyaW5nO1xyXG4gIF9vcHRpb25zOiBvcHRpb25zVHlwZTtcclxuXHJcbiAgX21pbjogbnVtYmVyO1xyXG4gIF9tYXg6IG51bWJlcjtcclxuICBfc3RlcDogbnVtYmVyO1xyXG4gIF9raW5kOiBzdHJpbmc7XHJcbiAgX2lzQmFzaWM6IGJvb2xlYW47XHJcbiAgX3ZhbHVlczogbnVtYmVyW107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yOiBzdHJpbmcsIG9wdGlvbnM/OiBvcHRpb25zVHlwZSkge1xyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcclxuICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IHt9XHJcbiAgICB0aGlzLl9taW4gPSBvcHRpb25zLm1pbiA/IG9wdGlvbnMubWluIDogMDtcclxuICAgIHRoaXMuX21heCA9IG9wdGlvbnMubWF4ID8gb3B0aW9ucy5tYXggOiAzMDA7XHJcbiAgICB0aGlzLl9zdGVwID0gb3B0aW9ucy5zdGVwID8gb3B0aW9ucy5zdGVwIDogNTc7XHJcbiAgICB0aGlzLl9raW5kID0gb3B0aW9ucy5raW5kID8gb3B0aW9ucy5raW5kIDogJ2hvcml6b250YWwnO1xyXG4gICAgdGhpcy5faXNCYXNpYyA9IG9wdGlvbnMuaXNCYXNpYyA/IG9wdGlvbnMuaXNCYXNpYyA6IHRydWU7XHJcbiAgICB0aGlzLl92YWx1ZXMgPSBvcHRpb25zLnZhbHVlcyA/IG9wdGlvbnMudmFsdWVzIDogW3RoaXMuX3N0ZXBdO1xyXG4gIH1cclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIGNvbnN0IG1vZGVsOiBNb2RlbCA9IG5ldyBNb2RlbCgpO1xyXG4gICAgY29uc3QgcHJlc2VudGVyID0gbmV3IFByZXNlbnRlcigpO1xyXG4gICAgbW9kZWwuYXR0YWNoKHByZXNlbnRlcik7XHJcbiAgICB0aGlzLnNldERhdGEoKTtcclxuICAgIG1vZGVsLmdldERhdGEodGhpcy5fb3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBzZXREYXRhKCkge1xyXG4gICAgdGhpcy5fb3B0aW9ucyA9IHtcclxuICAgICAgbWluOiB0aGlzLl9taW4sXHJcbiAgICAgIG1heDogdGhpcy5fbWF4LFxyXG4gICAgICBzdGVwOiB0aGlzLl9zdGVwLFxyXG4gICAgICBraW5kOiB0aGlzLl9raW5kLFxyXG4gICAgICBpc0Jhc2ljOiB0aGlzLl9pc0Jhc2ljLFxyXG4gICAgICB2YWx1ZXM6IHRoaXMuX3ZhbHVlc1xyXG4gICAgfTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX29wdGlvbnMpO1xyXG4gICAgLy8gaWYgKHRoaXMuX2lzQmFzaWMpIHtcclxuXHJcbiAgICAvLyB9XHJcbiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLl9zZWxlY3Rvcik7XHJcbiAgICAvLyBjb25zdCB2aWV3OiBWaWV3ID0gbmV3IFZpZXcodGhpcy5fc2VsZWN0b3IsIHRoaXMuX29wdGlvbnMpO1xyXG4gICAgLy8gdmlldy5zaG93U2xpZGVyKCk7XHJcblxyXG4gICAgLy8gY29uc3QgcHJlc2VudGVyOiBQcmVzZW50ZXIgPSBuZXcgUHJlc2VudGVyKHRoaXMuX3NlbGVjdG9yLCB0aGlzLl9vcHRpb25zKTtcclxuICAgIC8vIHByZXNlbnRlci5zZXREYXRhVG9Nb2RlbCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgJy4vc3R5bGUuc2Nzcyc7XHJcbmltcG9ydCBTbGlkZXIgZnJvbSAnLi9tb2R1bGVzL3NsaWRlcic7XHJcblxyXG4vLyBpbXBvcnQgc2xpZGVyUnVuIGZyb20gJy4vbW9kdWxlcy9zbGlkZXJSdW4nO1xyXG4vLyBpbXBvcnQgU2NhbGUgZnJvbSAnLi9tb2R1bGVzL3NjYWxlJztcclxuLy8gaW1wb3J0IHsgQ29uY3JldGVTdWJqZWN0IH0gZnJvbSAnLi9tb2R1bGVzL2FwcCc7XHJcbi8vIGltcG9ydCBWaWV3IGZyb20gJy4vbW9kdWxlcy92aWV3JztcclxuLy8gaW1wb3J0IE1vZGVsIGZyb20gJy4vbW9kdWxlcy9tb2RlbCc7XHJcbi8vIGltcG9ydCB7IENvbmNyZXRlT2JzZXJ2ZXJBLCBDb25jcmV0ZU9ic2VydmVyQiwgUHJlc2VudGVyIH0gZnJvbSAnLi9tb2R1bGVzL3ByZXNlbnRlcic7XHJcbi8vIGltcG9ydCB7IFByZXNlbnRlciB9IGZyb20gJy4vbW9kdWxlcy9wcmVzZW50ZXInO1xyXG5cclxuY29uc3Qgc2xpZGVyMTogU2xpZGVyID0gbmV3IFNsaWRlcignLnNsaWRlcjEnKTtcclxuc2xpZGVyMS5pbml0KCk7XHJcblxyXG5jb25zdCBzbGlkZXIyOiBTbGlkZXIgPSBuZXcgU2xpZGVyKCcuc2xpZGVyMicsIHttaW46IDQwLCBzdGVwOiA2MCwgbWF4OiAyNDV9KTtcclxuc2xpZGVyMi5pbml0KCk7XHJcblxyXG5jb25zdCBzbGlkZXIzOiBTbGlkZXIgPSBuZXcgU2xpZGVyKCcuc2xpZGVyMycsIHt2YWx1ZXM6IFsyNTZdfSk7XHJcbnNsaWRlcjMuaW5pdCgpO1xyXG5cclxuLy8gY29uc3QgdmlldzogVmlldyA9IG5ldyBWaWV3KCdyYW5nZS1zbGlkZXInKTtcclxuLy8gdmlldy5zaG93U2xpZGVyKCk7XHJcblxyXG5cclxuLy8gY29uc3Qgc2xpZGVyMjogVmlldyA9IG5ldyBWaWV3KCk7XHJcbi8vIHNsaWRlcjIuaGlkZSgpO1xyXG4vLyBjb25zdCBzbGlkZXIzOiBWaWV3ID0gbmV3IFZpZXcoJycpO1xyXG4vLyBzbGlkZXIzLmhpZGUoKTtcclxuXHJcbi8vIGNvbnN0IG1vZGVsID0gbmV3IE1vZGVsKHtcclxuLy8gICBtaW46IDQwLFxyXG4vLyAgIHN0ZXA6IDYwLFxyXG4vLyAgIG1heDogMjYwXHJcbi8vIH0pO1xyXG5cclxuLy8gY29uc3QgcHJlc2VudGVyID0gbmV3IFByZXNlbnRlcigpO1xyXG4vLyBtb2RlbC5hdHRhY2gocHJlc2VudGVyKTtcclxuXHJcbi8vIHByZXNlbnRlci5tb2RlbE9wdGlvbnMgPSBtb2RlbC5jYWxjVW5pdCgpO1xyXG4vLyBwcmVzZW50ZXIudHJhbnNmZXJNb2RlbERhdGEobW9kZWwsIHZpZXcpO1xyXG4vLyBtb2RlbC5jYWxjVW5pdCgpO1xyXG5cclxuLy8gdmlldy5zaG93U2xpZGVyKCk7XHJcblxyXG4vLyBjb25zdCBzY2FsZTogU2NhbGUgPSBuZXcgU2NhbGUoKTtcclxuLy8gc2NhbGUuaW5pdCgpO1xyXG5cclxuLy8gc2xpZGVyUnVuKCk7XHJcblxyXG4vLyBjb25zdCB2aWV3MjogVmlldyA9IG5ldyBWaWV3KCdzbGlkZXIyJyk7XHJcbi8vIHZpZXcyLnNob3dTbGlkZXIoKTtcclxuXHJcbi8qKlxyXG4qINCa0LvQuNC10L3RgtGB0LrQuNC5INC60L7QtC5cclxuKi9cclxuXHJcbi8vIGNvbnN0IHN1YmplY3QgPSBuZXcgQ29uY3JldGVTdWJqZWN0KCk7XHJcblxyXG4vLyBjb25zdCBvYnNlcnZlcjEgPSBuZXcgQ29uY3JldGVPYnNlcnZlckEoKTtcclxuLy8gc3ViamVjdC5hdHRhY2gob2JzZXJ2ZXIxKTtcclxuXHJcbi8vIGNvbnN0IG9ic2VydmVyMiA9IG5ldyBDb25jcmV0ZU9ic2VydmVyQigpO1xyXG4vLyBzdWJqZWN0LmF0dGFjaChvYnNlcnZlcjIpO1xyXG5cclxuLy8gc3ViamVjdC5zb21lQnVzaW5lc3NMb2dpYygpO1xyXG4vLyBzdWJqZWN0LnNvbWVCdXNpbmVzc0xvZ2ljKCk7XHJcblxyXG4vLyBzdWJqZWN0LmRldGFjaChvYnNlcnZlcjIpO1xyXG5cclxuLy8gc3ViamVjdC5zb21lQnVzaW5lc3NMb2dpYygpO1xyXG5cclxuLy8gY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudCcpO1xyXG5cclxuLy8gY29uc3QgdG9tOiBVc2VyID0gbmV3IFVzZXIoJ9Ci0L7QvCcsIDI5KTtcclxuLy8gZWwuaW5uZXJIVE1MID0gYNCY0LzRjzogJHt0b20ubmFtZX0g0LLQvtC30YDQsNGB0YI6ICR7dG9tLmFnZX1gO1xyXG5cclxuLyogY29uc3QgTVZQID0ge1xyXG4gIG1ha2VPYnNlcnZhYmxlU3ViamVjdCgpIHtcclxuICAgIGNvbnN0IG9ic2VydmVycyA9IFtdO1xyXG4gICAgY29uc3QgYWRkT2JzZXJ2ZXIgPSBmdW5jdGlvbiAobykge1xyXG4gICAgICBpZiAodHlwZW9mIG8gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ29ic2VydmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2JzZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBvYnNlcnZlcnNbaV07XHJcbiAgICAgICAgaWYgKG9ic2VydmVyID09PSBvKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ29ic2VydmVyIGFscmVhZHkgaW4gdGhlIGxpc3QnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgb2JzZXJ2ZXJzLnB1c2gobyk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVtb3ZlT2JzZXJ2ZXIgPSBmdW5jdGlvbiAobykge1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9ic2VydmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gb2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIGlmIChvYnNlcnZlciA9PT0gbykge1xyXG4gICAgICAgICAgb2JzZXJ2ZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgZmluZCBvYnNlcnZlciBpbiBsaXN0IG9mIG9ic2VydmVycycpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vdGlmeU9ic2VydmVycyA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIC8vIE1ha2UgYSBjb3B5IG9mIG9ic2VydmVyIGxpc3QgaW4gY2FzZSB0aGUgbGlzdFxyXG4gICAgICAvLyBpcyBtdXRhdGVkIGR1cmluZyB0aGUgbm90aWZpY2F0aW9ucy5cclxuICAgICAgY29uc3Qgb2JzZXJ2ZXJzU25hcHNob3QgPSBvYnNlcnZlcnMuc2xpY2UoMCk7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2JzZXJ2ZXJzU25hcHNob3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBvYnNlcnZlcnNTbmFwc2hvdFtpXShkYXRhKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFkZE9ic2VydmVyLFxyXG4gICAgICByZW1vdmVPYnNlcnZlcixcclxuICAgICAgbm90aWZ5T2JzZXJ2ZXJzLFxyXG4gICAgICBub3RpZnk6IG5vdGlmeU9ic2VydmVycyxcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgTW9kZWwob3B0aW9ucyA9IHt9KSB7XHJcbiAgICAvLyBjb25zdCB0aGF0ID0gdGhpcztcclxuICAgIC8vIGNvbnN0IGl0ZW1zID0gW107XHJcbiAgICB0aGlzLm9wdGlvbnMgPSAhb3B0aW9ucyA/IHt9IDogb3B0aW9ucztcclxuICAgIHRoaXMubW9kZWxDaGFuZ2VkU3ViamVjdCA9IE1WUC5tYWtlT2JzZXJ2YWJsZVN1YmplY3QoKTtcclxuICAgIHRoaXMubWluVmFsdWUgPSAwO1xyXG4gICAgdGhpcy5tYXhWYWx1ZSA9IDMwMDtcclxuICAgIHRoaXMuc3RlcCA9IDUwO1xyXG4gICAgdGhpcy5tb2RlID0gJ2hvcml6b250YWwnO1xyXG4gICAgdGhpcy50eXBlID0gJ3NpbmdsZSc7XHJcbiAgICAvLyB0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgIC8vICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgLy8gICAgIHJldHVybjtcclxuICAgIC8vICAgfVxyXG4gICAgLy8gICBpdGVtcy5wdXNoKHZhbHVlKTtcclxuICAgIC8vICAgdGhhdC5tb2RlbENoYW5nZWRTdWJqZWN0Lm5vdGlmeU9ic2VydmVycygpO1xyXG4gICAgLy8gfTtcclxuICAgIC8vIHRoaXMucmVtb3ZlQ3VycmVudEl0ZW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgIGlmICh0aGF0LnNlbGVjdGVkSW5kZXggPT09IC0xKSB7XHJcbiAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgLy8gICB9XHJcbiAgICAvLyAgIGl0ZW1zLnNwbGljZSh0aGF0LnNlbGVjdGVkSW5kZXgsIDEpO1xyXG4gICAgLy8gICB0aGF0Lm1vZGVsQ2hhbmdlZFN1YmplY3Qubm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAvLyB9O1xyXG4gICAgLy8gdGhpcy5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgcmV0dXJuIGl0ZW1zO1xyXG4gICAgLy8gfTtcclxuICAgIC8vIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xyXG4gICAgLy8gdGhpcy5nZXRTZWxlY3RlZEluZGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gICByZXR1cm4gdGhhdC5zZWxlY3RlZEluZGV4O1xyXG4gICAgLy8gfTtcclxuICAgIC8vIHRoaXMuc2V0U2VsZWN0ZWRJbmRleCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgLy8gICB0aGF0LnNlbGVjdGVkSW5kZXggPSB2YWx1ZTtcclxuICAgIC8vICAgdGhhdC5tb2RlbENoYW5nZWRTdWJqZWN0Lm5vdGlmeU9ic2VydmVycygpO1xyXG4gICAgLy8gfTtcclxuICB9LFxyXG5cclxuICBWaWV3KCkge1xyXG4gICAgLy8gY29uc3QgdGhhdCA9IHRoaXM7XHJcbiAgICB0aGlzLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNvbnN0IHNsaWRlckJvZHk6IFNsaWRlckJvZHkgPSBuZXcgU2xpZGVyQm9keSgpO1xyXG4gICAgICBzbGlkZXJCb2R5LmluaXQoKTtcclxuXHJcbiAgICAgIGNvbnN0IHNsaWRlclRodW1iOiBTbGlkZXJUaHVtYiA9IG5ldyBTbGlkZXJUaHVtYigpO1xyXG4gICAgICBzbGlkZXJUaHVtYi5pbml0KCk7XHJcblxyXG4gICAgICBjb25zdCB0aXBWYWx1ZTogVGlwVmFsdWUgPSBuZXcgVGlwVmFsdWUoKTtcclxuICAgICAgdGlwVmFsdWUuaW5pdCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyB0aGF0LnNlbGVjdCA9ICQoJzxzZWxlY3QvPicpLmFwcGVuZFRvKHJvb3RPYmplY3QpO1xyXG4gICAgLy8gdGhhdC5zZWxlY3QuYXR0cignc2l6ZScsICc0Jyk7XHJcbiAgICAvLyB0aGF0LmJ1dHRvbkFkZCA9ICQoJzxidXR0b24+KzwvYnV0dG9uPicpLmFwcGVuZFRvKHJvb3RPYmplY3QpLmhlaWdodCgyMCk7XHJcbiAgICAvLyB0aGF0LmJ1dHRvblJlbW92ZSA9ICQoJzxidXR0b24+LTwvYnV0dG9uPicpLmFwcGVuZFRvKHJvb3RPYmplY3QpLmhlaWdodCgyMCk7XHJcbiAgICAvLyBtb2RlbC5tb2RlbENoYW5nZWRTdWJqZWN0LmFkZE9ic2VydmVyKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgdmFyIGl0ZW1zID0gbW9kZWwuZ2V0SXRlbXMoKTtcclxuICAgIC8vICAgdmFyIGlubmVySFRNTCA9ICcnO1xyXG4gICAgLy8gICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSArPSAxKSB7XHJcbiAgICAvLyAgICAgaW5uZXJIVE1MICs9IFwiPG9wdGlvbj5cIiArIGl0ZW1zW2ldICsgXCI8L29wdGlvbj5cIjtcclxuICAgIC8vICAgfVxyXG4gICAgLy8gICB0aGF0LnNlbGVjdC5odG1sKGlubmVySFRNTCk7XHJcbiAgICAvLyB9KTtcclxuICB9LFxyXG5cclxuICBDb250cm9sbGVyKG1vZGVsLCB2aWV3KSB7XHJcbiAgICB2aWV3LmluaXQoKTtcclxuICAgIC8vIHZpZXcuYnV0dG9uQWRkLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gICBtb2RlbC5hZGRJdGVtKHByb21wdCgnYWRkdmFsdWUnKSk7XHJcbiAgICAvLyB9KTtcclxuICAgIC8vIHZpZXcuYnV0dG9uUmVtb3ZlLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gICBtb2RlbC5yZW1vdmVDdXJyZW50SXRlbSgpO1xyXG4gICAgLy8gfSk7XHJcbiAgICAvLyB2aWV3LnNlbGVjdC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgbW9kZWwuc2V0U2VsZWN0ZWRJbmRleCh2aWV3LnNlbGVjdFswXS5zZWxlY3RlZEluZGV4KTtcclxuICAgIC8vIH0pO1xyXG4gIH0sXHJcbn07ICovXHJcblxyXG4vKiAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIG1vZGVsID0gbmV3IE9NVkMuTW9kZWwoKTtcclxuICB2YXIgdmlldyA9IG5ldyBPTVZDLlZpZXcobW9kZWwsICQoJzxkaXYvPicpLmFwcGVuZFRvKCQoXCJib2R5XCIpKSk7XHJcbiAgdmFyIGNvbnRyb2xsZXIgPSBuZXcgT01WQy5Db250cm9sbGVyKG1vZGVsLCB2aWV3KTtcclxufSk7ICovXHJcblxyXG4vLyBjb25zdCBtb2RlbCA9IG5ldyBNVlAuTW9kZWwoKTtcclxuLy8gY29uc3QgdmlldyA9IG5ldyBNVlAuVmlldygpO1xyXG4vLyBjb25zdCBjb250cm9sbGVyID0gbmV3IE1WUC5Db250cm9sbGVyKG1vZGVsLCB2aWV3KTtcclxuXHJcbi8vIGNvbnRyb2xsZXIoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==