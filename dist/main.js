!function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist",i(i.s=3)}([function(e,t,i){var s=i(1),n=i(2);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};s(n,o);e.exports=n.locals||{}},function(e,t,i){"use strict";var s,n=function(){return void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s},o=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),r=[];function l(e){for(var t=-1,i=0;i<r.length;i++)if(r[i].identifier===e){t=i;break}return t}function a(e,t){for(var i={},s=[],n=0;n<e.length;n++){var o=e[n],a=t.base?o[0]+t.base:o[0],c=i[a]||0,u="".concat(a," ").concat(c);i[a]=c+1;var h=l(u),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(r[h].references++,r[h].updater(d)):r.push({identifier:u,updater:v(d,t),references:1}),s.push(u)}return s}function c(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var n=i.nc;n&&(s.nonce=n)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var r=o(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var u,h=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,i,s){var n=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=h(t,n);else{var o=document.createTextNode(n),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(o,r[t]):e.appendChild(o)}}function f(e,t,i){var s=i.css,n=i.media,o=i.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var m=null,p=0;function v(e,t){var i,s,n;if(t.singleton){var o=p++;i=m||(m=c(t)),s=d.bind(null,i,o,!1),n=d.bind(null,i,o,!0)}else i=c(t),s=f.bind(null,i,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var i=a(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<i.length;s++){var n=l(i[s]);r[n].references--}for(var o=a(e,t),c=0;c<i.length;c++){var u=l(i[c]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}i=o}}}},function(e,t,i){},function(e,t,i){"use strict";i.r(t);i(0);class s{constructor(e,t){this._elemId=e.slice(1),this._options=t}init(){this.lineElem=document.getElementById(this._elemId),this.thumbElem=document.createElement("DIV"),this.valueElem=document.createElement("DIV")}showSliderLine(){this.lineElem.classList.add("slider-body")}getPositionElement(e,t){return(t-this._options.min)*this.lineElem.offsetWidth/(this._options.max-this._options.min)-e.offsetWidth/2+"px"}showSliderThumb(){this.thumbElem.classList.add("slider-thumb"),this.lineElem.append(this.thumbElem),this.thumbElem.style.left=this.getPositionElement(this.thumbElem,this._options.values[0])}fillSliderLine(){this.lineElem.style.background=`linear-gradient(to right, red ${length}px, #e5e5e5 ${length}px)`}showSliderValue(){this.valueElem.classList.add("tip-value"),this.lineElem.append(this.valueElem),this.valueElem.textContent=""+Math.round((this.thumbElem.offsetLeft+this.thumbElem.offsetWidth/2-this.lineElem.offsetLeft)*(this._options.max-this._options.min)/this.lineElem.offsetWidth+this._options.min),this.valueElem.style.left=this.getPositionElement(this.valueElem,Number(this.valueElem.textContent))}}class n{communicate(e){this._selector=e._selector,this._options=e.getData();const t=new s(this._selector,this._options);t.init(),t.showSliderLine(),t.showSliderThumb(),t.showSliderValue(),console.log("ModelObserver: Reacted to the event.")}}class o{constructor(){this.observers=[]}attach(e){if(this.observers.includes(e))return console.log("Model: Presenter has been attached already.");console.log("Model: Attached a presenter."),this.observers.push(e)}detach(e){const t=this.observers.indexOf(e);if(-1===t)return console.log("Subject: Nonexistent observer.");this.observers.splice(t,1),console.log("Subject: Detached an observer.")}notify(){console.log("Model: Notifying observers...");for(const e of this.observers)e.communicate(this)}setData(e,t){this._min=e.min,this._max=e.max,this._step=e.step,this._kind=e.kind,this._isBasic=e.isBasic,this._values=e.values,this._selector=t,console.log("Model: My state has just changed"),this.notify()}getData(){return{min:this._min,max:this._max,step:this._step,kind:this._kind,isBasic:this._isBasic,values:this._values,selector:this._selector}}}class r{constructor(e,t){this._selector=e,t||(t={}),this._min=t.min?t.min:0,this._max=t.max?t.max:300,this._step=t.step?t.step:57,this._kind=t.kind?t.kind:"horizontal",this._isBasic=!t.isBasic||t.isBasic,this._values=t.values?t.values:[this._step]}init(){const e=new o,t=new n;e.attach(t),this.setData(),e.setData(this._options,this._selector)}setData(){this._options={min:this._min,max:this._max,step:this._step,kind:this._kind,isBasic:this._isBasic,values:this._values}}}new r("#slider1").init();new r("#slider2",{min:40,step:60,max:245}).init();new r("#slider3",{values:[300]}).init()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLnNjc3M/MjFiYSIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvdmlldy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbW9kdWxlcy9wcmVzZW50ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvbW9kZWwudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvc2xpZGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImFwaSIsImNvbnRlbnQiLCJkZWZhdWx0Iiwib3B0aW9ucyIsImxvY2FscyIsIm1lbW8iLCJpc09sZElFIiwiQm9vbGVhbiIsIndpbmRvdyIsImRvY3VtZW50IiwiYWxsIiwiYXRvYiIsImdldFRhcmdldCIsInRhcmdldCIsInN0eWxlVGFyZ2V0IiwicXVlcnlTZWxlY3RvciIsIkhUTUxJRnJhbWVFbGVtZW50IiwiY29udGVudERvY3VtZW50IiwiaGVhZCIsImUiLCJzdHlsZXNJbkRvbSIsImdldEluZGV4QnlJZGVudGlmaWVyIiwiaWRlbnRpZmllciIsInJlc3VsdCIsImxlbmd0aCIsIm1vZHVsZXNUb0RvbSIsImxpc3QiLCJpZENvdW50TWFwIiwiaWRlbnRpZmllcnMiLCJpdGVtIiwiaWQiLCJiYXNlIiwiY291bnQiLCJjb25jYXQiLCJpbmRleCIsIm9iaiIsImNzcyIsIm1lZGlhIiwic291cmNlTWFwIiwicmVmZXJlbmNlcyIsInVwZGF0ZXIiLCJwdXNoIiwiYWRkU3R5bGUiLCJpbnNlcnRTdHlsZUVsZW1lbnQiLCJzdHlsZSIsImNyZWF0ZUVsZW1lbnQiLCJhdHRyaWJ1dGVzIiwibm9uY2UiLCJrZXlzIiwiZm9yRWFjaCIsInNldEF0dHJpYnV0ZSIsImluc2VydCIsIkVycm9yIiwiYXBwZW5kQ2hpbGQiLCJ0ZXh0U3RvcmUiLCJyZXBsYWNlVGV4dCIsInJlcGxhY2VtZW50IiwiZmlsdGVyIiwiam9pbiIsImFwcGx5VG9TaW5nbGV0b25UYWciLCJyZW1vdmUiLCJzdHlsZVNoZWV0IiwiY3NzVGV4dCIsImNzc05vZGUiLCJjcmVhdGVUZXh0Tm9kZSIsImNoaWxkTm9kZXMiLCJyZW1vdmVDaGlsZCIsImluc2VydEJlZm9yZSIsImFwcGx5VG9UYWciLCJyZW1vdmVBdHRyaWJ1dGUiLCJidG9hIiwidW5lc2NhcGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJKU09OIiwic3RyaW5naWZ5IiwiZmlyc3RDaGlsZCIsInNpbmdsZXRvbiIsInNpbmdsZXRvbkNvdW50ZXIiLCJ1cGRhdGUiLCJzdHlsZUluZGV4IiwicGFyZW50Tm9kZSIsInJlbW92ZVN0eWxlRWxlbWVudCIsIm5ld09iaiIsImxhc3RJZGVudGlmaWVycyIsIm5ld0xpc3QiLCJ0b1N0cmluZyIsIm5ld0xhc3RJZGVudGlmaWVycyIsIl9pIiwiX2luZGV4Iiwic3BsaWNlIiwiVmlldyIsImVsZW1JZCIsInRoaXMiLCJfZWxlbUlkIiwic2xpY2UiLCJfb3B0aW9ucyIsImxpbmVFbGVtIiwiZ2V0RWxlbWVudEJ5SWQiLCJ0aHVtYkVsZW0iLCJ2YWx1ZUVsZW0iLCJjbGFzc0xpc3QiLCJhZGQiLCJlbGVtIiwidmFsIiwibWluIiwib2Zmc2V0V2lkdGgiLCJtYXgiLCJhcHBlbmQiLCJsZWZ0IiwiZ2V0UG9zaXRpb25FbGVtZW50IiwidmFsdWVzIiwiYmFja2dyb3VuZCIsInRleHRDb250ZW50IiwiTWF0aCIsInJvdW5kIiwib2Zmc2V0TGVmdCIsIk51bWJlciIsIm1vZGVsIiwiX3NlbGVjdG9yIiwiZ2V0RGF0YSIsInZpZXciLCJpbml0Iiwic2hvd1NsaWRlckxpbmUiLCJzaG93U2xpZGVyVGh1bWIiLCJzaG93U2xpZGVyVmFsdWUiLCJjb25zb2xlIiwibG9nIiwiTW9kZWwiLCJvYnNlcnZlcnMiLCJvYnNlcnZlciIsImluY2x1ZGVzIiwib2JzZXJ2ZXJJbmRleCIsImluZGV4T2YiLCJjb21tdW5pY2F0ZSIsInNlbGVjdG9yIiwiX21pbiIsIl9tYXgiLCJfc3RlcCIsInN0ZXAiLCJfa2luZCIsImtpbmQiLCJfaXNCYXNpYyIsImlzQmFzaWMiLCJfdmFsdWVzIiwibm90aWZ5IiwicHJlc2VudGVyIiwiYXR0YWNoIiwic2V0RGF0YSJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0ws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M0IsRUFDWnhGLElBQVNBLEVBQVUsSUFDeEJ5RixLQUFLMkMsS0FBT3BJLEVBQVFxRyxJQUFNckcsRUFBUXFHLElBQU0sRUFDeENaLEtBQUs0QyxLQUFPckksRUFBUXVHLElBQU12RyxFQUFRdUcsSUFBTSxJQUN4Q2QsS0FBSzZDLE1BQVF0SSxFQUFRdUksS0FBT3ZJLEVBQVF1SSxLQUFPLEdBQzNDOUMsS0FBSytDLE1BQVF4SSxFQUFReUksS0FBT3pJLEVBQVF5SSxLQUFPLGFBQzNDaEQsS0FBS2lELFVBQVcxSSxFQUFRMkksU0FBVTNJLEVBQVEySSxRQUMxQ2xELEtBQUttRCxRQUFVNUksRUFBUTJHLE9BQVMzRyxFQUFRMkcsT0FBUyxDQUFDbEIsS0FBSzZDLE9BR3pELE9BQ0UsTUFBTXBCLEVBQWUsSUFBSVUsRUFDbkJrQixFQUFZLElBQUksRUFDdEI1QixFQUFNNkIsT0FBT0QsR0FDYnJELEtBQUt1RCxVQUNMOUIsRUFBTThCLFFBQVF2RCxLQUFLRyxTQUFVSCxLQUFLMEIsV0FHcEMsVUFDRTFCLEtBQUtHLFNBQVcsQ0FDZFMsSUFBS1osS0FBSzJDLEtBQ1Y3QixJQUFLZCxLQUFLNEMsS0FDVkUsS0FBTTlDLEtBQUs2QyxNQUNYRyxLQUFNaEQsS0FBSytDLE1BQ1hHLFFBQVNsRCxLQUFLaUQsU0FDZC9CLE9BQVFsQixLQUFLbUQsVUN0Q0ssSUFBSSxFQUFPLFlBQzNCdEIsT0FFZ0IsSUFBSSxFQUFPLFdBQVksQ0FBQ2pCLElBQUssR0FBSWtDLEtBQU0sR0FBSWhDLElBQUssTUFDaEVlLE9BRWdCLElBQUksRUFBTyxXQUFZLENBQUNYLE9BQVEsQ0FBQyxPQUNqRFciLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL2Rpc3RcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwidmFyIGFwaSA9IHJlcXVpcmUoXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCIpO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi9ub2RlX21vZHVsZXMvbWluaS1jc3MtZXh0cmFjdC1wbHVnaW4vZGlzdC9sb2FkZXIuanMhLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vc3R5bGUuc2Nzc1wiKTtcblxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuX19lc01vZHVsZSA/IGNvbnRlbnQuZGVmYXVsdCA6IGNvbnRlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuICAgICAgICAgICAgfVxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLmluc2VydCA9IFwiaGVhZFwiO1xub3B0aW9ucy5zaW5nbGV0b24gPSBmYWxzZTtcblxudmFyIHVwZGF0ZSA9IGFwaShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHMgfHwge307IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBpc09sZElFID0gZnVuY3Rpb24gaXNPbGRJRSgpIHtcbiAgdmFyIG1lbW87XG4gIHJldHVybiBmdW5jdGlvbiBtZW1vcml6ZSgpIHtcbiAgICBpZiAodHlwZW9mIG1lbW8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvLyBUZXN0IGZvciBJRSA8PSA5IGFzIHByb3Bvc2VkIGJ5IEJyb3dzZXJoYWNrc1xuICAgICAgLy8gQHNlZSBodHRwOi8vYnJvd3NlcmhhY2tzLmNvbS8jaGFjay1lNzFkODY5MmY2NTMzNDE3M2ZlZTcxNWMyMjJjYjgwNVxuICAgICAgLy8gVGVzdHMgZm9yIGV4aXN0ZW5jZSBvZiBzdGFuZGFyZCBnbG9iYWxzIGlzIHRvIGFsbG93IHN0eWxlLWxvYWRlclxuICAgICAgLy8gdG8gb3BlcmF0ZSBjb3JyZWN0bHkgaW50byBub24tc3RhbmRhcmQgZW52aXJvbm1lbnRzXG4gICAgICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrLWNvbnRyaWIvc3R5bGUtbG9hZGVyL2lzc3Vlcy8xNzdcbiAgICAgIG1lbW8gPSBCb29sZWFuKHdpbmRvdyAmJiBkb2N1bWVudCAmJiBkb2N1bWVudC5hbGwgJiYgIXdpbmRvdy5hdG9iKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVtbztcbiAgfTtcbn0oKTtcblxudmFyIGdldFRhcmdldCA9IGZ1bmN0aW9uIGdldFRhcmdldCgpIHtcbiAgdmFyIG1lbW8gPSB7fTtcbiAgcmV0dXJuIGZ1bmN0aW9uIG1lbW9yaXplKHRhcmdldCkge1xuICAgIGlmICh0eXBlb2YgbWVtb1t0YXJnZXRdID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdmFyIHN0eWxlVGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpOyAvLyBTcGVjaWFsIGNhc2UgdG8gcmV0dXJuIGhlYWQgb2YgaWZyYW1lIGluc3RlYWQgb2YgaWZyYW1lIGl0c2VsZlxuXG4gICAgICBpZiAod2luZG93LkhUTUxJRnJhbWVFbGVtZW50ICYmIHN0eWxlVGFyZ2V0IGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gVGhpcyB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhY2Nlc3MgdG8gaWZyYW1lIGlzIGJsb2NrZWRcbiAgICAgICAgICAvLyBkdWUgdG8gY3Jvc3Mtb3JpZ2luIHJlc3RyaWN0aW9uc1xuICAgICAgICAgIHN0eWxlVGFyZ2V0ID0gc3R5bGVUYXJnZXQuY29udGVudERvY3VtZW50LmhlYWQ7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxuICAgICAgICAgIHN0eWxlVGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtZW1vW3RhcmdldF0gPSBzdHlsZVRhcmdldDtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVtb1t0YXJnZXRdO1xuICB9O1xufSgpO1xuXG52YXIgc3R5bGVzSW5Eb20gPSBbXTtcblxuZnVuY3Rpb24gZ2V0SW5kZXhCeUlkZW50aWZpZXIoaWRlbnRpZmllcikge1xuICB2YXIgcmVzdWx0ID0gLTE7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXNJbkRvbS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChzdHlsZXNJbkRvbVtpXS5pZGVudGlmaWVyID09PSBpZGVudGlmaWVyKSB7XG4gICAgICByZXN1bHQgPSBpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gbW9kdWxlc1RvRG9tKGxpc3QsIG9wdGlvbnMpIHtcbiAgdmFyIGlkQ291bnRNYXAgPSB7fTtcbiAgdmFyIGlkZW50aWZpZXJzID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgIHZhciBpZCA9IG9wdGlvbnMuYmFzZSA/IGl0ZW1bMF0gKyBvcHRpb25zLmJhc2UgOiBpdGVtWzBdO1xuICAgIHZhciBjb3VudCA9IGlkQ291bnRNYXBbaWRdIHx8IDA7XG4gICAgdmFyIGlkZW50aWZpZXIgPSBcIlwiLmNvbmNhdChpZCwgXCIgXCIpLmNvbmNhdChjb3VudCk7XG4gICAgaWRDb3VudE1hcFtpZF0gPSBjb3VudCArIDE7XG4gICAgdmFyIGluZGV4ID0gZ2V0SW5kZXhCeUlkZW50aWZpZXIoaWRlbnRpZmllcik7XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIGNzczogaXRlbVsxXSxcbiAgICAgIG1lZGlhOiBpdGVtWzJdLFxuICAgICAgc291cmNlTWFwOiBpdGVtWzNdXG4gICAgfTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIHN0eWxlc0luRG9tW2luZGV4XS5yZWZlcmVuY2VzKys7XG4gICAgICBzdHlsZXNJbkRvbVtpbmRleF0udXBkYXRlcihvYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZXNJbkRvbS5wdXNoKHtcbiAgICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllcixcbiAgICAgICAgdXBkYXRlcjogYWRkU3R5bGUob2JqLCBvcHRpb25zKSxcbiAgICAgICAgcmVmZXJlbmNlczogMVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWRlbnRpZmllcnMucHVzaChpZGVudGlmaWVyKTtcbiAgfVxuXG4gIHJldHVybiBpZGVudGlmaWVycztcbn1cblxuZnVuY3Rpb24gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpIHtcbiAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgdmFyIGF0dHJpYnV0ZXMgPSBvcHRpb25zLmF0dHJpYnV0ZXMgfHwge307XG5cbiAgaWYgKHR5cGVvZiBhdHRyaWJ1dGVzLm5vbmNlID09PSAndW5kZWZpbmVkJykge1xuICAgIHZhciBub25jZSA9IHR5cGVvZiBfX3dlYnBhY2tfbm9uY2VfXyAhPT0gJ3VuZGVmaW5lZCcgPyBfX3dlYnBhY2tfbm9uY2VfXyA6IG51bGw7XG5cbiAgICBpZiAobm9uY2UpIHtcbiAgICAgIGF0dHJpYnV0ZXMubm9uY2UgPSBub25jZTtcbiAgICB9XG4gIH1cblxuICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICB9KTtcblxuICBpZiAodHlwZW9mIG9wdGlvbnMuaW5zZXJ0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgb3B0aW9ucy5pbnNlcnQoc3R5bGUpO1xuICB9IGVsc2Uge1xuICAgIHZhciB0YXJnZXQgPSBnZXRUYXJnZXQob3B0aW9ucy5pbnNlcnQgfHwgJ2hlYWQnKTtcblxuICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBmaW5kIGEgc3R5bGUgdGFyZ2V0LiBUaGlzIHByb2JhYmx5IG1lYW5zIHRoYXQgdGhlIHZhbHVlIGZvciB0aGUgJ2luc2VydCcgcGFyYW1ldGVyIGlzIGludmFsaWQuXCIpO1xuICAgIH1cblxuICAgIHRhcmdldC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIH1cblxuICByZXR1cm4gc3R5bGU7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSkge1xuICAvLyBpc3RhbmJ1bCBpZ25vcmUgaWZcbiAgaWYgKHN0eWxlLnBhcmVudE5vZGUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBzdHlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlKTtcbn1cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICAqL1xuXG5cbnZhciByZXBsYWNlVGV4dCA9IGZ1bmN0aW9uIHJlcGxhY2VUZXh0KCkge1xuICB2YXIgdGV4dFN0b3JlID0gW107XG4gIHJldHVybiBmdW5jdGlvbiByZXBsYWNlKGluZGV4LCByZXBsYWNlbWVudCkge1xuICAgIHRleHRTdG9yZVtpbmRleF0gPSByZXBsYWNlbWVudDtcbiAgICByZXR1cm4gdGV4dFN0b3JlLmZpbHRlcihCb29sZWFuKS5qb2luKCdcXG4nKTtcbiAgfTtcbn0oKTtcblxuZnVuY3Rpb24gYXBwbHlUb1NpbmdsZXRvblRhZyhzdHlsZSwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XG4gIHZhciBjc3MgPSByZW1vdmUgPyAnJyA6IG9iai5tZWRpYSA/IFwiQG1lZGlhIFwiLmNvbmNhdChvYmoubWVkaWEsIFwiIHtcIikuY29uY2F0KG9iai5jc3MsIFwifVwiKSA6IG9iai5jc3M7IC8vIEZvciBvbGQgSUVcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgICovXG5cbiAgaWYgKHN0eWxlLnN0eWxlU2hlZXQpIHtcbiAgICBzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSByZXBsYWNlVGV4dChpbmRleCwgY3NzKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XG4gICAgdmFyIGNoaWxkTm9kZXMgPSBzdHlsZS5jaGlsZE5vZGVzO1xuXG4gICAgaWYgKGNoaWxkTm9kZXNbaW5kZXhdKSB7XG4gICAgICBzdHlsZS5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XG4gICAgfVxuXG4gICAgaWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICBzdHlsZS5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZS5hcHBlbmRDaGlsZChjc3NOb2RlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gYXBwbHlUb1RhZyhzdHlsZSwgb3B0aW9ucywgb2JqKSB7XG4gIHZhciBjc3MgPSBvYmouY3NzO1xuICB2YXIgbWVkaWEgPSBvYmoubWVkaWE7XG4gIHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xuXG4gIGlmIChtZWRpYSkge1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnbWVkaWEnLCBtZWRpYSk7XG4gIH0gZWxzZSB7XG4gICAgc3R5bGUucmVtb3ZlQXR0cmlidXRlKCdtZWRpYScpO1xuICB9XG5cbiAgaWYgKHNvdXJjZU1hcCAmJiBidG9hKSB7XG4gICAgY3NzICs9IFwiXFxuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxcIi5jb25jYXQoYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSwgXCIgKi9cIik7XG4gIH0gLy8gRm9yIG9sZCBJRVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAgKi9cblxuXG4gIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7XG4gICAgc3R5bGUuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xuICB9IGVsc2Uge1xuICAgIHdoaWxlIChzdHlsZS5maXJzdENoaWxkKSB7XG4gICAgICBzdHlsZS5yZW1vdmVDaGlsZChzdHlsZS5maXJzdENoaWxkKTtcbiAgICB9XG5cbiAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcbiAgfVxufVxuXG52YXIgc2luZ2xldG9uID0gbnVsbDtcbnZhciBzaW5nbGV0b25Db3VudGVyID0gMDtcblxuZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XG4gIHZhciBzdHlsZTtcbiAgdmFyIHVwZGF0ZTtcbiAgdmFyIHJlbW92ZTtcblxuICBpZiAob3B0aW9ucy5zaW5nbGV0b24pIHtcbiAgICB2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcbiAgICBzdHlsZSA9IHNpbmdsZXRvbiB8fCAoc2luZ2xldG9uID0gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpKTtcbiAgICB1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIGZhbHNlKTtcbiAgICByZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIHRydWUpO1xuICB9IGVsc2Uge1xuICAgIHN0eWxlID0gaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpO1xuICAgIHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZSwgb3B0aW9ucyk7XG5cbiAgICByZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGUpO1xuICAgIH07XG4gIH1cblxuICB1cGRhdGUob2JqKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG5ld09iaikge1xuICAgIGlmIChuZXdPYmopIHtcbiAgICAgIGlmIChuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB1cGRhdGUob2JqID0gbmV3T2JqKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlKCk7XG4gICAgfVxuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChsaXN0LCBvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OyAvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cbiAgLy8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxuXG4gIGlmICghb3B0aW9ucy5zaW5nbGV0b24gJiYgdHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uICE9PSAnYm9vbGVhbicpIHtcbiAgICBvcHRpb25zLnNpbmdsZXRvbiA9IGlzT2xkSUUoKTtcbiAgfVxuXG4gIGxpc3QgPSBsaXN0IHx8IFtdO1xuICB2YXIgbGFzdElkZW50aWZpZXJzID0gbW9kdWxlc1RvRG9tKGxpc3QsIG9wdGlvbnMpO1xuICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcbiAgICBuZXdMaXN0ID0gbmV3TGlzdCB8fCBbXTtcblxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobmV3TGlzdCkgIT09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhc3RJZGVudGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGlkZW50aWZpZXIgPSBsYXN0SWRlbnRpZmllcnNbaV07XG4gICAgICB2YXIgaW5kZXggPSBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKTtcbiAgICAgIHN0eWxlc0luRG9tW2luZGV4XS5yZWZlcmVuY2VzLS07XG4gICAgfVxuXG4gICAgdmFyIG5ld0xhc3RJZGVudGlmaWVycyA9IG1vZHVsZXNUb0RvbShuZXdMaXN0LCBvcHRpb25zKTtcblxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBsYXN0SWRlbnRpZmllcnMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICB2YXIgX2lkZW50aWZpZXIgPSBsYXN0SWRlbnRpZmllcnNbX2ldO1xuXG4gICAgICB2YXIgX2luZGV4ID0gZ2V0SW5kZXhCeUlkZW50aWZpZXIoX2lkZW50aWZpZXIpO1xuXG4gICAgICBpZiAoc3R5bGVzSW5Eb21bX2luZGV4XS5yZWZlcmVuY2VzID09PSAwKSB7XG4gICAgICAgIHN0eWxlc0luRG9tW19pbmRleF0udXBkYXRlcigpO1xuXG4gICAgICAgIHN0eWxlc0luRG9tLnNwbGljZShfaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxhc3RJZGVudGlmaWVycyA9IG5ld0xhc3RJZGVudGlmaWVycztcbiAgfTtcbn07IiwiaW1wb3J0IFNjYWxlIGZyb20gJy4vc2NhbGUnO1xyXG5cclxudHlwZSBvcHRpb25zVHlwZSA9IHtcclxuICBtaW4/OiBudW1iZXIsXHJcbiAgbWF4PzogbnVtYmVyLFxyXG4gIHN0ZXA/OiBudW1iZXIsXHJcbiAga2luZD86IHN0cmluZyxcclxuICBpc0Jhc2ljPzogYm9vbGVhbixcclxuICB2YWx1ZXM/OiBudW1iZXJbXVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlldyB7XHJcbiAgX2VsZW1JZDogc3RyaW5nO1xyXG4gIF9vcHRpb25zOiBvcHRpb25zVHlwZTtcclxuICBsaW5lRWxlbTogSFRNTEVsZW1lbnQ7XHJcbiAgdGh1bWJFbGVtOiBIVE1MRWxlbWVudDtcclxuICB2YWx1ZUVsZW06IEhUTUxFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3RvcihlbGVtSWQ6IHN0cmluZywgb3B0aW9uczogb3B0aW9uc1R5cGUpIHtcclxuICAgIHRoaXMuX2VsZW1JZCA9IGVsZW1JZC5zbGljZSgxKTtcclxuICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xyXG4gIH07XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICB0aGlzLmxpbmVFbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5fZWxlbUlkKTtcclxuICAgIHRoaXMudGh1bWJFbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICB0aGlzLnZhbHVlRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gIH1cclxuXHJcbiAgc2hvd1NsaWRlckxpbmUoKSB7XHJcbiAgICB0aGlzLmxpbmVFbGVtLmNsYXNzTGlzdC5hZGQoJ3NsaWRlci1ib2R5Jyk7XHJcbiAgfVxyXG5cclxuICBnZXRQb3NpdGlvbkVsZW1lbnQoZWxlbTogSFRNTEVsZW1lbnQsIHZhbDogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gYCR7KHZhbCAtIHRoaXMuX29wdGlvbnMubWluKSAqIHRoaXMubGluZUVsZW0ub2Zmc2V0V2lkdGggLyAodGhpcy5fb3B0aW9ucy5tYXggLSB0aGlzLl9vcHRpb25zLm1pbikgLSBlbGVtLm9mZnNldFdpZHRoIC8gMn1weGA7XHJcbiAgfVxyXG5cclxuICBzaG93U2xpZGVyVGh1bWIoKSB7XHJcbiAgICB0aGlzLnRodW1iRWxlbS5jbGFzc0xpc3QuYWRkKCdzbGlkZXItdGh1bWInKTtcclxuICAgIHRoaXMubGluZUVsZW0uYXBwZW5kKHRoaXMudGh1bWJFbGVtKTtcclxuICAgIHRoaXMudGh1bWJFbGVtLnN0eWxlLmxlZnQgPSB0aGlzLmdldFBvc2l0aW9uRWxlbWVudCh0aGlzLnRodW1iRWxlbSwgdGhpcy5fb3B0aW9ucy52YWx1ZXNbMF0pO1xyXG4gIH1cclxuXHJcbiAgZmlsbFNsaWRlckxpbmUoKSB7XHJcbiAgICB0aGlzLmxpbmVFbGVtLnN0eWxlLmJhY2tncm91bmQgPSBgbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCByZWQgJHtsZW5ndGh9cHgsICNlNWU1ZTUgJHtsZW5ndGh9cHgpYDtcclxuICB9XHJcblxyXG4gIHNob3dTbGlkZXJWYWx1ZSgpIHtcclxuICAgIHRoaXMudmFsdWVFbGVtLmNsYXNzTGlzdC5hZGQoJ3RpcC12YWx1ZScpO1xyXG4gICAgdGhpcy5saW5lRWxlbS5hcHBlbmQodGhpcy52YWx1ZUVsZW0pO1xyXG4gICAgdGhpcy52YWx1ZUVsZW0udGV4dENvbnRlbnQgPSBgJHtNYXRoLnJvdW5kKCh0aGlzLnRodW1iRWxlbS5vZmZzZXRMZWZ0ICsgdGhpcy50aHVtYkVsZW0ub2Zmc2V0V2lkdGggLyAyIC0gdGhpcy5saW5lRWxlbS5vZmZzZXRMZWZ0KSAqICh0aGlzLl9vcHRpb25zLm1heCAtIHRoaXMuX29wdGlvbnMubWluKSAvIHRoaXMubGluZUVsZW0ub2Zmc2V0V2lkdGggKyB0aGlzLl9vcHRpb25zLm1pbil9YDtcclxuICAgIHRoaXMudmFsdWVFbGVtLnN0eWxlLmxlZnQgPSB0aGlzLmdldFBvc2l0aW9uRWxlbWVudCh0aGlzLnZhbHVlRWxlbSwgTnVtYmVyKHRoaXMudmFsdWVFbGVtLnRleHRDb250ZW50KSk7XHJcbiAgfVxyXG5cclxuICAvLyBzaG93U2NhbGUobWluOiBudW1iZXIsIG1heDogbnVtYmVyLCBzdGVwOiBudW1iZXIpIHtcclxuICAvLyAgIHRoaXMuX21pblZhbHVlID0gbWluO1xyXG4gIC8vICAgdGhpcy5fbWF4VmFsdWUgPSBtYXg7XHJcbiAgLy8gICB0aGlzLl9zdGVwVmFsdWUgPSBzdGVwO1xyXG4gIC8vICAgLy8gY29uc29sZS5sb2codGhpcy5fcGFyZW50SWQpO1xyXG4gIC8vICAgY29uc3Qgc2NhbGU6IFNjYWxlID0gbmV3IFNjYWxlKHRoaXMuX3NlbGVjdG9yLCB0aGlzLl9taW5WYWx1ZSwgdGhpcy5fbWF4VmFsdWUsIHRoaXMuX3N0ZXBWYWx1ZSk7XHJcbiAgLy8gICBzY2FsZS5pbml0KCk7XHJcbiAgLy8gfVxyXG59XHJcbiIsIi8vIGltcG9ydCB7IFN1YmplY3QsIENvbmNyZXRlU3ViamVjdCB9IGZyb20gJy4vYXBwJztcclxuaW1wb3J0IFN1YmplY3QgZnJvbSAnLi9hcHAnO1xyXG5pbXBvcnQgTW9kZWwgZnJvbSAnLi9tb2RlbCc7XHJcbmltcG9ydCBWaWV3IGZyb20gJy4vdmlldyc7XHJcblxyXG50eXBlIG9wdGlvbnNUeXBlID0ge1xyXG4gIG1pbj86IG51bWJlcixcclxuICBtYXg/OiBudW1iZXIsXHJcbiAgc3RlcD86IG51bWJlcixcclxuICBraW5kPzogc3RyaW5nLFxyXG4gIGlzQmFzaWM/OiBib29sZWFuLFxyXG4gIHZhbHVlcz86IG51bWJlcltdXHJcbn07XHJcblxyXG4vKipcclxuKiDQmNC90YLQtdGA0YTQtdC50YEg0J3QsNCx0LvRjtC00LDRgtC10LvRjyDQvtCx0YrRj9Cy0LvRj9C10YIg0LzQtdGC0L7QtCDRg9Cy0LXQtNC+0LzQu9C10L3QuNGPLCDQutC+0YLQvtGA0YvQuSDQuNC30LTQsNGC0LXQu9C4XHJcbiog0LjRgdC/0L7Qu9GM0LfRg9GO0YIg0LTQu9GPINC+0L/QvtCy0LXRidC10L3QuNGPINGB0LLQvtC40YUg0L/QvtC00L/QuNGB0YfQuNC60L7Qsi5cclxuKi9cclxuaW50ZXJmYWNlIE9ic2VydmVyIHtcclxuICAvLyDQn9C+0LvRg9GH0LjRgtGMINC+0LHQvdC+0LLQu9C10L3QuNC1INC+0YIg0YHRg9Cx0YrQtdC60YLQsC5cclxuICBjb21tdW5pY2F0ZShzdWJqZWN0OiBTdWJqZWN0KTogdm9pZDtcclxufVxyXG5cclxuLyoqXHJcbiog0JrQvtC90LrRgNC10YLQvdGL0LUg0J3QsNCx0LvRjtC00LDRgtC10LvQuCDRgNC10LDQs9C40YDRg9GO0YIg0L3QsCDQvtCx0L3QvtCy0LvQtdC90LjRjywg0LLRi9C/0YPRidC10L3QvdGL0LUg0JjQt9C00LDRgtC10LvQtdC8LCDQulxyXG4qINC60L7RgtC+0YDQvtC80YMg0L7QvdC4INC/0YDQuNC60YDQtdC/0LvQtdC90YsuXHJcbiovXHJcbi8vIGNsYXNzIENvbmNyZXRlT2JzZXJ2ZXJBIGltcGxlbWVudHMgT2JzZXJ2ZXIge1xyXG4vLyAgIHB1YmxpYyB1cGRhdGUoc3ViamVjdDogU3ViamVjdCk6IHZvaWQge1xyXG4vLyAgICAgaWYgKHN1YmplY3QgaW5zdGFuY2VvZiBDb25jcmV0ZVN1YmplY3QgJiYgc3ViamVjdC5zdGF0ZSA8IDMpIHtcclxuLy8gICAgICAgY29uc29sZS5sb2coJ0NvbmNyZXRlT2JzZXJ2ZXJBOiBSZWFjdGVkIHRvIHRoZSBldmVudC4nKTtcclxuLy8gICAgIH1cclxuLy8gICB9XHJcbi8vIH1cclxuXHJcbmNsYXNzIFByZXNlbnRlciBpbXBsZW1lbnRzIE9ic2VydmVyIHtcclxuICAvLyBtb2RlbE9wdGlvbnM6IHttaW46IG51bWJlciwgbWF4OiBudW1iZXIsIHN0ZXA6IG51bWJlcn07XHJcbiAgX3NlbGVjdG9yOiBzdHJpbmc7XHJcbiAgX29wdGlvbnM6IG9wdGlvbnNUeXBlO1xyXG5cclxuICAvLyBjb25zdHJ1Y3RvcihzZWxlY3Rvcj86IHN0cmluZywgb3B0aW9ucz86IG9wdGlvbnNUeXBlKSB7XHJcbiAgLy8gICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gIC8vICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgLy8gfVxyXG5cclxuICAvLyBzZXREYXRhVG9Nb2RlbCgpIHtcclxuICAvLyAgIGNvbnN0IG1vZGVsOiBNb2RlbCA9IG5ldyBNb2RlbCgpO1xyXG4gIC8vICAgbW9kZWwuZ2V0RGF0YSgpO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gdHJhbnNmZXJNb2RlbERhdGEobW9kZWw6IE1vZGVsLCB2aWV3OiBWaWV3KSB7XHJcbiAgLy8gICB0aGlzLm1vZGVsT3B0aW9ucyA9IG1vZGVsLmNhbGNVbml0KCk7XHJcbiAgLy8gICBjb25zb2xlLmxvZyh0aGlzLm1vZGVsT3B0aW9ucyk7XHJcbiAgLy8gICB2aWV3LnNob3dTY2FsZSh0aGlzLm1vZGVsT3B0aW9ucy5taW4sIHRoaXMubW9kZWxPcHRpb25zLm1heCwgdGhpcy5tb2RlbE9wdGlvbnMuc3RlcCk7XHJcbiAgLy8gICAvLyBjb25zb2xlLmxvZygnTW9kZWxPYnNlcnZlcjogUmVhY3RlZCB0byB0aGUgZXZlbnQuJyk7XHJcbiAgLy8gICAvLyBpZiAobW9kZWwgaW5zdGFuY2VvZiBNb2RlbCkge1xyXG4gIC8vICAgLy8gICB0aGlzLm1vZGVsT3B0aW9ucyA9IG1vZGVsLmNhbGNVbml0KCk7XHJcbiAgLy8gICAvLyAgIGNvbnNvbGUubG9nKHRoaXMubW9kZWxPcHRpb25zKTtcclxuICAvLyAgICAgLy8gY29uc3QgdmlldyA9IG5ldyBWaWV3KCk7XHJcbiAgLy8gICAgIC8vIHZpZXcuc2hvd1NjYWxlKHRoaXMubW9kZWxPcHRpb25zLm1pbiwgdGhpcy5tb2RlbE9wdGlvbnMubWF4LCB0aGlzLm1vZGVsT3B0aW9ucy5zdGVwKTtcclxuICAvLyAgICAgLy8gY29uc29sZS5sb2coJ01vZGVsT2JzZXJ2ZXI6IFJlYWN0ZWQgdG8gdGhlIGV2ZW50LicpO1xyXG4gIC8vICAgLy8gfVxyXG4gIC8vIH1cclxuXHJcbiAgLy8gdHJhbnNmZXIoKSB7XHJcbiAgLy8gICBjb25zdCB2aWV3OiBWaWV3ID0gbmV3IFZpZXcoKTtcclxuICAgIC8vIHJldHVybiB2aWV3LmdldFdpZHRoU2xpZGVyKCk7XHJcbiAgLy8gfVxyXG5cclxuICBjb21tdW5pY2F0ZShtb2RlbDogTW9kZWwpIHtcclxuICAgIHRoaXMuX3NlbGVjdG9yID0gbW9kZWwuX3NlbGVjdG9yO1xyXG4gICAgdGhpcy5fb3B0aW9ucyA9IG1vZGVsLmdldERhdGEoKTtcclxuICAgIGNvbnN0IHZpZXc6IFZpZXcgPSBuZXcgVmlldyh0aGlzLl9zZWxlY3RvciwgdGhpcy5fb3B0aW9ucyk7XHJcbiAgICB2aWV3LmluaXQoKTtcclxuICAgIHZpZXcuc2hvd1NsaWRlckxpbmUoKTtcclxuICAgIHZpZXcuc2hvd1NsaWRlclRodW1iKCk7XHJcbiAgICB2aWV3LnNob3dTbGlkZXJWYWx1ZSgpO1xyXG4gICAgY29uc29sZS5sb2coJ01vZGVsT2JzZXJ2ZXI6IFJlYWN0ZWQgdG8gdGhlIGV2ZW50LicpO1xyXG4gICAgLy8gaWYgKG1vZGVsIGluc3RhbmNlb2YgTW9kZWwpIHtcclxuICAgIC8vICAgdGhpcy5tb2RlbE9wdGlvbnMgPSBtb2RlbC5jYWxjVW5pdCgpO1xyXG4gICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLm1vZGVsT3B0aW9ucyk7XHJcbiAgICAvLyAgIGNvbnN0IHZpZXcgPSBuZXcgVmlldygpO1xyXG4gICAgLy8gICB2aWV3LnNob3dTY2FsZSh0aGlzLm1vZGVsT3B0aW9ucy5taW4sIHRoaXMubW9kZWxPcHRpb25zLm1heCwgdGhpcy5tb2RlbE9wdGlvbnMuc3RlcCk7XHJcbiAgICAvLyAgIGNvbnNvbGUubG9nKCdNb2RlbE9ic2VydmVyOiBSZWFjdGVkIHRvIHRoZSBldmVudC4nKTtcclxuICAgIC8vIH1cclxuICB9XHJcblxyXG4gIC8vIGdldFNsaWRlckRhdGEoKSB7XHJcbiAgLy8gICByZXR1cm4ge1xyXG4gIC8vICAgICBzZWxlY3RvcjogdGhpcy5fc2VsZWN0b3IsXHJcbiAgLy8gICAgIG9wdGlvbnM6IHRoaXMuX29wdGlvbnNcclxuICAvLyAgIH07XHJcbiAgLy8gfVxyXG59XHJcblxyXG4vLyBjbGFzcyBWaWV3T2JzZXJ2ZXIgaW1wbGVtZW50cyBPYnNlcnZlciB7XHJcbi8vICAgdXBkYXRlKHZpZXcpIHtcclxuXHJcbi8vICAgfVxyXG4vLyB9XHJcblxyXG4vLyBjbGFzcyBDb25jcmV0ZU9ic2VydmVyQiBpbXBsZW1lbnRzIE9ic2VydmVyIHtcclxuLy8gICBpc1N1YmplY3RTYXRpc2ZpZXMoc3ViamVjdCkge1xyXG4vLyAgICAgcmV0dXJuIHN1YmplY3QgaW5zdGFuY2VvZiBDb25jcmV0ZVN1YmplY3QgJiYgKHN1YmplY3Quc3RhdGUgPT09IDAgfHwgc3ViamVjdC5zdGF0ZSA+PSAyKTtcclxuLy8gICB9XHJcblxyXG4vLyAgIHB1YmxpYyB1cGRhdGUoc3ViamVjdDogU3ViamVjdCk6IHZvaWQge1xyXG4vLyAgICAgaWYgKHRoaXMuaXNTdWJqZWN0U2F0aXNmaWVzKHN1YmplY3QpKSB7XHJcbi8vICAgICAgIGNvbnNvbGUubG9nKCdDb25jcmV0ZU9ic2VydmVyQjogUmVhY3RlZCB0byB0aGUgZXZlbnQuJyk7XHJcbi8vICAgICB9XHJcbi8vICAgfVxyXG4vLyB9XHJcblxyXG4vLyBleHBvcnQgeyBPYnNlcnZlciwgQ29uY3JldGVPYnNlcnZlckEsIENvbmNyZXRlT2JzZXJ2ZXJCLCBQcmVzZW50ZXIgfTtcclxuZXhwb3J0IHsgT2JzZXJ2ZXIsIFByZXNlbnRlciB9O1xyXG4iLCIvLyBpbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAnLi9hcHAnO1xyXG5pbXBvcnQgU3ViamVjdCBmcm9tICcuL2FwcCc7XHJcbmltcG9ydCB7IE9ic2VydmVyIH0gZnJvbSAnLi9wcmVzZW50ZXInO1xyXG5cclxudHlwZSBvcHRpb25zID0ge1xyXG4gIG1pbj86IG51bWJlcjtcclxuICBtYXg/OiBudW1iZXI7XHJcbiAgc3RlcD86IG51bWJlcjtcclxuICBraW5kPzogc3RyaW5nO1xyXG4gIGlzQmFzaWM/OiBib29sZWFuO1xyXG4gIHZhbHVlcz86IG51bWJlcltdO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kZWwgaW1wbGVtZW50cyBTdWJqZWN0IHtcclxuICBwcml2YXRlIF9taW46IG51bWJlcjtcclxuICBwcml2YXRlIF9tYXg6IG51bWJlcjtcclxuICBwcml2YXRlIF9zdGVwOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBfa2luZDogc3RyaW5nO1xyXG4gIHByaXZhdGUgX2lzQmFzaWM6IGJvb2xlYW47XHJcbiAgcHJpdmF0ZSBfdmFsdWVzOiBudW1iZXJbXTtcclxuICBfc2VsZWN0b3I6IHN0cmluZztcclxuXHJcbiAgLy8gY29uc3RydWN0b3Iob3B0aW9ucz86IG9wdGlvbnMpIHtcclxuICAvLyAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IHt9XHJcbiAgLy8gICB0aGlzLl9taW4gPSBvcHRpb25zLm1pbiA/IG9wdGlvbnMubWluIDogMDtcclxuICAvLyAgIHRoaXMuX21heCA9IG9wdGlvbnMubWF4ID8gb3B0aW9ucy5tYXggOiAzMDA7XHJcbiAgLy8gICB0aGlzLl9zdGVwID0gb3B0aW9ucy5zdGVwID8gb3B0aW9ucy5zdGVwIDogNTA7XHJcbiAgLy8gICB0aGlzLl9raW5kID0gb3B0aW9ucy5raW5kID8gb3B0aW9ucy5raW5kIDogJ2hvcml6b250YWwnO1xyXG4gIC8vICAgdGhpcy5faXNCYXNpYyA9IG9wdGlvbnMuaXNCYXNpYyA/IG9wdGlvbnMuaXNCYXNpYyA6IHRydWU7XHJcbiAgICAvLyB0aGlzLm5vdGlmeSgpO1xyXG4gIC8vIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHR5cGUge09ic2VydmVyW119INCh0L/QuNGB0L7QuiDQv9C+0LTQv9C40YHRh9C40LrQvtCyLiDQkiDRgNC10LDQu9GM0L3QvtC5INC20LjQt9C90Lgg0YHQv9C40YHQvtC6XHJcbiAgICog0L/QvtC00L/QuNGB0YfQuNC60L7QsiDQvNC+0LbQtdGCINGF0YDQsNC90LjRgtGM0YHRjyDQsiDQsdC+0LvQtdC1INC/0L7QtNGA0L7QsdC90L7QvCDQstC40LTQtSAo0LrQu9Cw0YHRgdC40YTQuNGG0LjRgNGD0LXRgtGB0Y8g0L/QvlxyXG4gICAqINGC0LjQv9GDINGB0L7QsdGL0YLQuNGPINC4INGCLtC0LilcclxuICAgKi9cclxuICBwcml2YXRlIG9ic2VydmVyczogT2JzZXJ2ZXJbXSA9IFtdO1xyXG5cclxuICAvKipcclxuICAgKiDQnNC10YLQvtC00Ysg0YPQv9GA0LDQstC70LXQvdC40Y8g0L/QvtC00L/QuNGB0LrQvtC5LlxyXG4gICAqL1xyXG4gIHB1YmxpYyBhdHRhY2gob2JzZXJ2ZXI6IE9ic2VydmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCBpc0V4aXN0ID0gdGhpcy5vYnNlcnZlcnMuaW5jbHVkZXMob2JzZXJ2ZXIpO1xyXG4gICAgaWYgKGlzRXhpc3QpIHtcclxuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCdNb2RlbDogUHJlc2VudGVyIGhhcyBiZWVuIGF0dGFjaGVkIGFscmVhZHkuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ01vZGVsOiBBdHRhY2hlZCBhIHByZXNlbnRlci4nKTtcclxuICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGRldGFjaChvYnNlcnZlcjogT2JzZXJ2ZXIpOiB2b2lkIHtcclxuICAgIGNvbnN0IG9ic2VydmVySW5kZXggPSB0aGlzLm9ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKTtcclxuICAgIGlmIChvYnNlcnZlckluZGV4ID09PSAtMSkge1xyXG4gICAgICByZXR1cm4gY29uc29sZS5sb2coJ1N1YmplY3Q6IE5vbmV4aXN0ZW50IG9ic2VydmVyLicpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMub2JzZXJ2ZXJzLnNwbGljZShvYnNlcnZlckluZGV4LCAxKTtcclxuICAgIGNvbnNvbGUubG9nKCdTdWJqZWN0OiBEZXRhY2hlZCBhbiBvYnNlcnZlci4nKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqINCX0LDQv9GD0YHQuiDQvtCx0L3QvtCy0LvQtdC90LjRjyDQsiDQutCw0LbQtNC+0Lwg0L/QvtC00L/QuNGB0YfQuNC60LUuXHJcbiAgICovXHJcbiAgcHVibGljIG5vdGlmeSgpOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKCdNb2RlbDogTm90aWZ5aW5nIG9ic2VydmVycy4uLicpO1xyXG4gICAgZm9yIChjb25zdCBvYnNlcnZlciBvZiB0aGlzLm9ic2VydmVycykge1xyXG4gICAgICBvYnNlcnZlci5jb21tdW5pY2F0ZSh0aGlzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldERhdGEob3B0aW9uczogb3B0aW9ucywgc2VsZWN0b3I6IHN0cmluZykge1xyXG4gICAgdGhpcy5fbWluID0gb3B0aW9ucy5taW47XHJcbiAgICB0aGlzLl9tYXggPSBvcHRpb25zLm1heDtcclxuICAgIHRoaXMuX3N0ZXAgPSBvcHRpb25zLnN0ZXA7XHJcbiAgICB0aGlzLl9raW5kID0gb3B0aW9ucy5raW5kO1xyXG4gICAgdGhpcy5faXNCYXNpYyA9IG9wdGlvbnMuaXNCYXNpYztcclxuICAgIHRoaXMuX3ZhbHVlcyA9IG9wdGlvbnMudmFsdWVzO1xyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcclxuICAgIGNvbnNvbGUubG9nKGBNb2RlbDogTXkgc3RhdGUgaGFzIGp1c3QgY2hhbmdlZGApO1xyXG4gICAgdGhpcy5ub3RpZnkoKTtcclxuICB9XHJcblxyXG4gIGdldERhdGEoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBtaW46IHRoaXMuX21pbixcclxuICAgICAgbWF4OiB0aGlzLl9tYXgsXHJcbiAgICAgIHN0ZXA6IHRoaXMuX3N0ZXAsXHJcbiAgICAgIGtpbmQ6IHRoaXMuX2tpbmQsXHJcbiAgICAgIGlzQmFzaWM6IHRoaXMuX2lzQmFzaWMsXHJcbiAgICAgIHZhbHVlczogdGhpcy5fdmFsdWVzLFxyXG4gICAgICBzZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIGNhbGNVbml0KCkge1xyXG4gIC8vICAgY29uc29sZS5sb2coYE1vZGVsOiBNeSBzdGF0ZSBoYXMganVzdCBjaGFuZ2VkYCk7XHJcblxyXG4gIC8vICAgcmV0dXJuIHtcclxuICAvLyAgICAgbWluOiB0aGlzLl9taW4sXHJcbiAgLy8gICAgIG1heDogdGhpcy5fbWF4LFxyXG4gIC8vICAgICBzdGVwOiB0aGlzLl9zdGVwXHJcbiAgLy8gICB9O1xyXG4gIC8vIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQcmVzZW50ZXIgfSBmcm9tICcuL3ByZXNlbnRlcic7XHJcbmltcG9ydCBNb2RlbCBmcm9tICcuL21vZGVsJztcclxuXHJcbnR5cGUgb3B0aW9uc1R5cGUgPSB7XHJcbiAgbWluPzogbnVtYmVyLFxyXG4gIG1heD86IG51bWJlcixcclxuICBzdGVwPzogbnVtYmVyLFxyXG4gIGtpbmQ/OiBzdHJpbmcsXHJcbiAgaXNCYXNpYz86IGJvb2xlYW4sXHJcbiAgdmFsdWVzPzogbnVtYmVyW11cclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNsaWRlciB7XHJcbiAgX3NlbGVjdG9yOiBzdHJpbmc7XHJcbiAgX29wdGlvbnM6IG9wdGlvbnNUeXBlO1xyXG5cclxuICBfbWluOiBudW1iZXI7XHJcbiAgX21heDogbnVtYmVyO1xyXG4gIF9zdGVwOiBudW1iZXI7XHJcbiAgX2tpbmQ6IHN0cmluZztcclxuICBfaXNCYXNpYzogYm9vbGVhbjtcclxuICBfdmFsdWVzOiBudW1iZXJbXTtcclxuXHJcbiAgY29uc3RydWN0b3IoZWxlbUlkOiBzdHJpbmcsIG9wdGlvbnM/OiBvcHRpb25zVHlwZSkge1xyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBlbGVtSWQ7XHJcbiAgICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fVxyXG4gICAgdGhpcy5fbWluID0gb3B0aW9ucy5taW4gPyBvcHRpb25zLm1pbiA6IDA7XHJcbiAgICB0aGlzLl9tYXggPSBvcHRpb25zLm1heCA/IG9wdGlvbnMubWF4IDogMzAwO1xyXG4gICAgdGhpcy5fc3RlcCA9IG9wdGlvbnMuc3RlcCA/IG9wdGlvbnMuc3RlcCA6IDU3O1xyXG4gICAgdGhpcy5fa2luZCA9IG9wdGlvbnMua2luZCA/IG9wdGlvbnMua2luZCA6ICdob3Jpem9udGFsJztcclxuICAgIHRoaXMuX2lzQmFzaWMgPSBvcHRpb25zLmlzQmFzaWMgPyBvcHRpb25zLmlzQmFzaWMgOiB0cnVlO1xyXG4gICAgdGhpcy5fdmFsdWVzID0gb3B0aW9ucy52YWx1ZXMgPyBvcHRpb25zLnZhbHVlcyA6IFt0aGlzLl9zdGVwXTtcclxuICB9XHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICBjb25zdCBtb2RlbDogTW9kZWwgPSBuZXcgTW9kZWwoKTtcclxuICAgIGNvbnN0IHByZXNlbnRlciA9IG5ldyBQcmVzZW50ZXIoKTtcclxuICAgIG1vZGVsLmF0dGFjaChwcmVzZW50ZXIpO1xyXG4gICAgdGhpcy5zZXREYXRhKCk7XHJcbiAgICBtb2RlbC5zZXREYXRhKHRoaXMuX29wdGlvbnMsIHRoaXMuX3NlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHNldERhdGEoKSB7XHJcbiAgICB0aGlzLl9vcHRpb25zID0ge1xyXG4gICAgICBtaW46IHRoaXMuX21pbixcclxuICAgICAgbWF4OiB0aGlzLl9tYXgsXHJcbiAgICAgIHN0ZXA6IHRoaXMuX3N0ZXAsXHJcbiAgICAgIGtpbmQ6IHRoaXMuX2tpbmQsXHJcbiAgICAgIGlzQmFzaWM6IHRoaXMuX2lzQmFzaWMsXHJcbiAgICAgIHZhbHVlczogdGhpcy5fdmFsdWVzXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgJy4vc3R5bGUuc2Nzcyc7XHJcbmltcG9ydCBTbGlkZXIgZnJvbSAnLi9tb2R1bGVzL3NsaWRlcic7XHJcblxyXG4vLyBpbXBvcnQgc2xpZGVyUnVuIGZyb20gJy4vbW9kdWxlcy9zbGlkZXJSdW4nO1xyXG4vLyBpbXBvcnQgU2NhbGUgZnJvbSAnLi9tb2R1bGVzL3NjYWxlJztcclxuLy8gaW1wb3J0IHsgQ29uY3JldGVTdWJqZWN0IH0gZnJvbSAnLi9tb2R1bGVzL2FwcCc7XHJcbi8vIGltcG9ydCBWaWV3IGZyb20gJy4vbW9kdWxlcy92aWV3JztcclxuLy8gaW1wb3J0IE1vZGVsIGZyb20gJy4vbW9kdWxlcy9tb2RlbCc7XHJcbi8vIGltcG9ydCB7IENvbmNyZXRlT2JzZXJ2ZXJBLCBDb25jcmV0ZU9ic2VydmVyQiwgUHJlc2VudGVyIH0gZnJvbSAnLi9tb2R1bGVzL3ByZXNlbnRlcic7XHJcbi8vIGltcG9ydCB7IFByZXNlbnRlciB9IGZyb20gJy4vbW9kdWxlcy9wcmVzZW50ZXInO1xyXG5cclxuY29uc3Qgc2xpZGVyMTogU2xpZGVyID0gbmV3IFNsaWRlcignI3NsaWRlcjEnKTtcclxuc2xpZGVyMS5pbml0KCk7XHJcblxyXG5jb25zdCBzbGlkZXIyOiBTbGlkZXIgPSBuZXcgU2xpZGVyKCcjc2xpZGVyMicsIHttaW46IDQwLCBzdGVwOiA2MCwgbWF4OiAyNDV9KTtcclxuc2xpZGVyMi5pbml0KCk7XHJcblxyXG5jb25zdCBzbGlkZXIzOiBTbGlkZXIgPSBuZXcgU2xpZGVyKCcjc2xpZGVyMycsIHt2YWx1ZXM6IFszMDBdfSk7XHJcbnNsaWRlcjMuaW5pdCgpO1xyXG5cclxuLy8gY29uc3Qgc2NhbGU6IFNjYWxlID0gbmV3IFNjYWxlKCk7XHJcbi8vIHNjYWxlLmluaXQoKTtcclxuXHJcbi8vIHNsaWRlclJ1bigpO1xyXG5cclxuLy8gY29uc3QgdmlldzI6IFZpZXcgPSBuZXcgVmlldygnc2xpZGVyMicpO1xyXG4vLyB2aWV3Mi5zaG93U2xpZGVyKCk7XHJcblxyXG4vKipcclxuKiDQmtC70LjQtdC90YLRgdC60LjQuSDQutC+0LQuXHJcbiovXHJcblxyXG4vLyBjb25zdCBzdWJqZWN0ID0gbmV3IENvbmNyZXRlU3ViamVjdCgpO1xyXG5cclxuLy8gY29uc3Qgb2JzZXJ2ZXIxID0gbmV3IENvbmNyZXRlT2JzZXJ2ZXJBKCk7XHJcbi8vIHN1YmplY3QuYXR0YWNoKG9ic2VydmVyMSk7XHJcblxyXG4vLyBjb25zdCBvYnNlcnZlcjIgPSBuZXcgQ29uY3JldGVPYnNlcnZlckIoKTtcclxuLy8gc3ViamVjdC5hdHRhY2gob2JzZXJ2ZXIyKTtcclxuXHJcbi8vIHN1YmplY3Quc29tZUJ1c2luZXNzTG9naWMoKTtcclxuLy8gc3ViamVjdC5zb21lQnVzaW5lc3NMb2dpYygpO1xyXG5cclxuLy8gc3ViamVjdC5kZXRhY2gob2JzZXJ2ZXIyKTtcclxuXHJcbi8vIHN1YmplY3Quc29tZUJ1c2luZXNzTG9naWMoKTtcclxuXHJcbi8vIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnQnKTtcclxuXHJcbi8vIGNvbnN0IHRvbTogVXNlciA9IG5ldyBVc2VyKCfQotC+0LwnLCAyOSk7XHJcbi8vIGVsLmlubmVySFRNTCA9IGDQmNC80Y86ICR7dG9tLm5hbWV9INCy0L7Qt9GA0LDRgdGCOiAke3RvbS5hZ2V9YDtcclxuXHJcbi8qIGNvbnN0IE1WUCA9IHtcclxuICBtYWtlT2JzZXJ2YWJsZVN1YmplY3QoKSB7XHJcbiAgICBjb25zdCBvYnNlcnZlcnMgPSBbXTtcclxuICAgIGNvbnN0IGFkZE9ic2VydmVyID0gZnVuY3Rpb24gKG8pIHtcclxuICAgICAgaWYgKHR5cGVvZiBvICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdvYnNlcnZlciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9ic2VydmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gb2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIGlmIChvYnNlcnZlciA9PT0gbykge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdvYnNlcnZlciBhbHJlYWR5IGluIHRoZSBsaXN0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIG9ic2VydmVycy5wdXNoKG8pO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHJlbW92ZU9ic2VydmVyID0gZnVuY3Rpb24gKG8pIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYnNlcnZlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG9ic2VydmVyc1tpXTtcclxuICAgICAgICBpZiAob2JzZXJ2ZXIgPT09IG8pIHtcclxuICAgICAgICAgIG9ic2VydmVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IGZpbmQgb2JzZXJ2ZXIgaW4gbGlzdCBvZiBvYnNlcnZlcnMnKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBub3RpZnlPYnNlcnZlcnMgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAvLyBNYWtlIGEgY29weSBvZiBvYnNlcnZlciBsaXN0IGluIGNhc2UgdGhlIGxpc3RcclxuICAgICAgLy8gaXMgbXV0YXRlZCBkdXJpbmcgdGhlIG5vdGlmaWNhdGlvbnMuXHJcbiAgICAgIGNvbnN0IG9ic2VydmVyc1NuYXBzaG90ID0gb2JzZXJ2ZXJzLnNsaWNlKDApO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9ic2VydmVyc1NuYXBzaG90Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgb2JzZXJ2ZXJzU25hcHNob3RbaV0oZGF0YSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZGRPYnNlcnZlcixcclxuICAgICAgcmVtb3ZlT2JzZXJ2ZXIsXHJcbiAgICAgIG5vdGlmeU9ic2VydmVycyxcclxuICAgICAgbm90aWZ5OiBub3RpZnlPYnNlcnZlcnMsXHJcbiAgICB9O1xyXG4gIH0sXHJcblxyXG4gIE1vZGVsKG9wdGlvbnMgPSB7fSkge1xyXG4gICAgLy8gY29uc3QgdGhhdCA9IHRoaXM7XHJcbiAgICAvLyBjb25zdCBpdGVtcyA9IFtdO1xyXG4gICAgdGhpcy5vcHRpb25zID0gIW9wdGlvbnMgPyB7fSA6IG9wdGlvbnM7XHJcbiAgICB0aGlzLm1vZGVsQ2hhbmdlZFN1YmplY3QgPSBNVlAubWFrZU9ic2VydmFibGVTdWJqZWN0KCk7XHJcbiAgICB0aGlzLm1pblZhbHVlID0gMDtcclxuICAgIHRoaXMubWF4VmFsdWUgPSAzMDA7XHJcbiAgICB0aGlzLnN0ZXAgPSA1MDtcclxuICAgIHRoaXMubW9kZSA9ICdob3Jpem9udGFsJztcclxuICAgIHRoaXMudHlwZSA9ICdzaW5nbGUnO1xyXG4gICAgLy8gdGhpcy5hZGRJdGVtID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAvLyAgIGlmICghdmFsdWUpIHtcclxuICAgIC8vICAgICByZXR1cm47XHJcbiAgICAvLyAgIH1cclxuICAgIC8vICAgaXRlbXMucHVzaCh2YWx1ZSk7XHJcbiAgICAvLyAgIHRoYXQubW9kZWxDaGFuZ2VkU3ViamVjdC5ub3RpZnlPYnNlcnZlcnMoKTtcclxuICAgIC8vIH07XHJcbiAgICAvLyB0aGlzLnJlbW92ZUN1cnJlbnRJdGVtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gICBpZiAodGhhdC5zZWxlY3RlZEluZGV4ID09PSAtMSkge1xyXG4gICAgLy8gICAgIHJldHVybjtcclxuICAgIC8vICAgfVxyXG4gICAgLy8gICBpdGVtcy5zcGxpY2UodGhhdC5zZWxlY3RlZEluZGV4LCAxKTtcclxuICAgIC8vICAgdGhhdC5tb2RlbENoYW5nZWRTdWJqZWN0Lm5vdGlmeU9ic2VydmVycygpO1xyXG4gICAgLy8gfTtcclxuICAgIC8vIHRoaXMuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgIHJldHVybiBpdGVtcztcclxuICAgIC8vIH07XHJcbiAgICAvLyB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgIC8vIHRoaXMuZ2V0U2VsZWN0ZWRJbmRleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgcmV0dXJuIHRoYXQuc2VsZWN0ZWRJbmRleDtcclxuICAgIC8vIH07XHJcbiAgICAvLyB0aGlzLnNldFNlbGVjdGVkSW5kZXggPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgIC8vICAgdGhhdC5zZWxlY3RlZEluZGV4ID0gdmFsdWU7XHJcbiAgICAvLyAgIHRoYXQubW9kZWxDaGFuZ2VkU3ViamVjdC5ub3RpZnlPYnNlcnZlcnMoKTtcclxuICAgIC8vIH07XHJcbiAgfSxcclxuXHJcbiAgVmlldygpIHtcclxuICAgIC8vIGNvbnN0IHRoYXQgPSB0aGlzO1xyXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBjb25zdCBzbGlkZXJCb2R5OiBTbGlkZXJCb2R5ID0gbmV3IFNsaWRlckJvZHkoKTtcclxuICAgICAgc2xpZGVyQm9keS5pbml0KCk7XHJcblxyXG4gICAgICBjb25zdCBzbGlkZXJUaHVtYjogU2xpZGVyVGh1bWIgPSBuZXcgU2xpZGVyVGh1bWIoKTtcclxuICAgICAgc2xpZGVyVGh1bWIuaW5pdCgpO1xyXG5cclxuICAgICAgY29uc3QgdGlwVmFsdWU6IFRpcFZhbHVlID0gbmV3IFRpcFZhbHVlKCk7XHJcbiAgICAgIHRpcFZhbHVlLmluaXQoKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gdGhhdC5zZWxlY3QgPSAkKCc8c2VsZWN0Lz4nKS5hcHBlbmRUbyhyb290T2JqZWN0KTtcclxuICAgIC8vIHRoYXQuc2VsZWN0LmF0dHIoJ3NpemUnLCAnNCcpO1xyXG4gICAgLy8gdGhhdC5idXR0b25BZGQgPSAkKCc8YnV0dG9uPis8L2J1dHRvbj4nKS5hcHBlbmRUbyhyb290T2JqZWN0KS5oZWlnaHQoMjApO1xyXG4gICAgLy8gdGhhdC5idXR0b25SZW1vdmUgPSAkKCc8YnV0dG9uPi08L2J1dHRvbj4nKS5hcHBlbmRUbyhyb290T2JqZWN0KS5oZWlnaHQoMjApO1xyXG4gICAgLy8gbW9kZWwubW9kZWxDaGFuZ2VkU3ViamVjdC5hZGRPYnNlcnZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgIHZhciBpdGVtcyA9IG1vZGVsLmdldEl0ZW1zKCk7XHJcbiAgICAvLyAgIHZhciBpbm5lckhUTUwgPSAnJztcclxuICAgIC8vICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMSkge1xyXG4gICAgLy8gICAgIGlubmVySFRNTCArPSBcIjxvcHRpb24+XCIgKyBpdGVtc1tpXSArIFwiPC9vcHRpb24+XCI7XHJcbiAgICAvLyAgIH1cclxuICAgIC8vICAgdGhhdC5zZWxlY3QuaHRtbChpbm5lckhUTUwpO1xyXG4gICAgLy8gfSk7XHJcbiAgfSxcclxuXHJcbiAgQ29udHJvbGxlcihtb2RlbCwgdmlldykge1xyXG4gICAgdmlldy5pbml0KCk7XHJcbiAgICAvLyB2aWV3LmJ1dHRvbkFkZC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgbW9kZWwuYWRkSXRlbShwcm9tcHQoJ2FkZHZhbHVlJykpO1xyXG4gICAgLy8gfSk7XHJcbiAgICAvLyB2aWV3LmJ1dHRvblJlbW92ZS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgbW9kZWwucmVtb3ZlQ3VycmVudEl0ZW0oKTtcclxuICAgIC8vIH0pO1xyXG4gICAgLy8gdmlldy5zZWxlY3QuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgIG1vZGVsLnNldFNlbGVjdGVkSW5kZXgodmlldy5zZWxlY3RbMF0uc2VsZWN0ZWRJbmRleCk7XHJcbiAgICAvLyB9KTtcclxuICB9LFxyXG59OyAqL1xyXG5cclxuLyogJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gIHZhciBtb2RlbCA9IG5ldyBPTVZDLk1vZGVsKCk7XHJcbiAgdmFyIHZpZXcgPSBuZXcgT01WQy5WaWV3KG1vZGVsLCAkKCc8ZGl2Lz4nKS5hcHBlbmRUbygkKFwiYm9keVwiKSkpO1xyXG4gIHZhciBjb250cm9sbGVyID0gbmV3IE9NVkMuQ29udHJvbGxlcihtb2RlbCwgdmlldyk7XHJcbn0pOyAqL1xyXG5cclxuLy8gY29uc3QgbW9kZWwgPSBuZXcgTVZQLk1vZGVsKCk7XHJcbi8vIGNvbnN0IHZpZXcgPSBuZXcgTVZQLlZpZXcoKTtcclxuLy8gY29uc3QgY29udHJvbGxlciA9IG5ldyBNVlAuQ29udHJvbGxlcihtb2RlbCwgdmlldyk7XHJcblxyXG4vLyBjb250cm9sbGVyKCk7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=